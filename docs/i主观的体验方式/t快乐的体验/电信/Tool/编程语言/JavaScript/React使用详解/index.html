<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">React使用详解 | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://flyskywhy.github.io/g/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://flyskywhy.github.io/g/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://flyskywhy.github.io/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="React使用详解 | My Site"><meta data-rh="true" name="description" content="Li Zheng flyskywhy@gmail.com"><meta data-rh="true" property="og:description" content="Li Zheng flyskywhy@gmail.com"><link data-rh="true" rel="icon" href="/g/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://flyskywhy.github.io/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解"><link data-rh="true" rel="alternate" href="https://flyskywhy.github.io/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解" hreflang="en"><link data-rh="true" rel="alternate" href="https://flyskywhy.github.io/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"React使用详解","item":"https://flyskywhy.github.io/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解"}]}</script><link rel="alternate" type="application/rss+xml" href="/g/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/g/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/g/assets/css/styles.faf98e1c.css">
<script src="/g/assets/js/runtime~main.f17f2787.js" defer="defer"></script>
<script src="/g/assets/js/main.fd282c03.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/g/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/g/"><div class="navbar__logo"><img src="/g/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/g/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/g/docs/">文档</a><a href="https://github.com/flyskywhy/g" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/g/docs/"><span title="README" class="linkLabel_WmDU">README</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/g/docs/i主观的体验方式/i悲伤的体验/中医/中药的“威力”"><span title="i主观的体验方式" class="categoryLinkLabel_W154">i主观的体验方式</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/i悲伤的体验/中医/中药的“威力”"><span title="i悲伤的体验" class="categoryLinkLabel_W154">i悲伤的体验</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/商/Pm/小团队项目管理软件的的选择"><span title="t快乐的体验" class="categoryLinkLabel_W154">t快乐的体验</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/商/Pm/小团队项目管理软件的的选择"><span title="商" class="categoryLinkLabel_W154">商</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/处世/如何做好人生最重要的事——选择"><span title="处世" class="categoryLinkLabel_W154">处世</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/手机/手机投屏到手机的方法"><span title="手机" class="categoryLinkLabel_W154">手机</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/政/atLJJ"><span title="政" class="categoryLinkLabel_W154">政</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Cpu/Riscv/LicheeRV使用详解"><span title="电信" class="categoryLinkLabel_W154">电信</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Cpu/Riscv/LicheeRV使用详解"><span title="Cpu" class="categoryLinkLabel_W154">Cpu</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Education/"><span title="README" class="linkLabel_WmDU">README</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Fs/Ipfs/Ipfs使用详解"><span title="Fs" class="categoryLinkLabel_W154">Fs</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Net/Vpn/VPN路由设置详解"><span title="Net" class="categoryLinkLabel_W154">Net</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Os/AliOsThings/BoneEngine使用详解"><span title="Os" class="categoryLinkLabel_W154">Os</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Test/Firebase使用详解"><span title="Test" class="categoryLinkLabel_W154">Test</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/Probe/Fs2/mips仿真器gdb调试方法"><span title="Tool" class="categoryLinkLabel_W154">Tool</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/Probe/Fs2/mips仿真器gdb调试方法"><span title="Probe" class="categoryLinkLabel_W154">Probe</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/文件管理/Syncthing/Syncthing在网络化测试机项目中的应用方式"><span title="文件管理" class="categoryLinkLabel_W154">文件管理</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/文档编辑/Maqetta/Maqetta使用详解"><span title="文档编辑" class="categoryLinkLabel_W154">文档编辑</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/C/C语言编码规范"><span title="编程语言" class="categoryLinkLabel_W154">编程语言</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/C/C语言编码规范"><span title="C" class="categoryLinkLabel_W154">C</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/Go/Go使用详解"><span title="Go" class="categoryLinkLabel_W154">Go</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/JavaScript精选包"><span title="JavaScript" class="categoryLinkLabel_W154">JavaScript</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/JavaScript精选包"><span title="JavaScript精选包" class="linkLabel_WmDU">JavaScript精选包</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/JavaScript编码规范"><span title="JavaScript编码规范" class="linkLabel_WmDU">JavaScript编码规范</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/ReactNative优化"><span title="ReactNative优化" class="linkLabel_WmDU">ReactNative优化</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/ReactNative项目中使用Appium进行测试的方法"><span title="ReactNative项目中使用Appium进行测试的方法" class="linkLabel_WmDU">ReactNative项目中使用Appium进行测试的方法</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/ReactNative项目中命令行编译iOS版的方法"><span title="ReactNative项目中命令行编译iOS版的方法" class="linkLabel_WmDU">ReactNative项目中命令行编译iOS版的方法</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/ReactNative项目中把任意二进制文件打包进APP的方法"><span title="ReactNative项目中把任意二进制文件打包进APP的方法" class="linkLabel_WmDU">ReactNative项目中把任意二进制文件打包进APP的方法</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/React使用详解"><span title="React使用详解" class="linkLabel_WmDU">React使用详解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/emsdk使用详解"><span title="emsdk使用详解" class="linkLabel_WmDU">emsdk使用详解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/js比ts更好用"><span title="js比ts更好用" class="linkLabel_WmDU">js比ts更好用</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/nodec使用详解"><span title="nodec使用详解" class="linkLabel_WmDU">nodec使用详解</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/Python/Python使用详解"><span title="Python" class="categoryLinkLabel_W154">Python</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/翻墙/Clash使用详解"><span title="翻墙" class="categoryLinkLabel_W154">翻墙</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/配置管理/Git/GitLab使用详解"><span title="配置管理" class="categoryLinkLabel_W154">配置管理</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Video/PyTorch使用详解"><span title="Video" class="categoryLinkLabel_W154">Video</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/画/Ai/fastsdcpu使用详解"><span title="画" class="categoryLinkLabel_W154">画</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/g/docs/i主观的体验方式/t快乐的体验/行/杭州老和山游步道、杭州乐园2日游"><span title="行" class="categoryLinkLabel_W154">行</span></a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/g/docs/t客观的存在原理/i人体内部的存在/t肉体/现代医学的哲学理念"><span title="t客观的存在原理" class="categoryLinkLabel_W154">t客观的存在原理</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/g/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">i主观的体验方式</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">t快乐的体验</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">电信</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tool</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">编程语言</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">JavaScript</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">React使用详解</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p>Li Zheng <a href="mailto:flyskywhy@gmail.com" target="_blank" rel="noopener noreferrer">flyskywhy@gmail.com</a></p>
<header><h1>React 使用详解</h1></header>
<p>React 并不是简单地在 Javascript 中嵌入 HTML ，而是对 UI （包括 web 和 APP）渲染的方式进行了革新。而且， <a href="https://developer.aliyun.com/article/115052" target="_blank" rel="noopener noreferrer">选择 React 是商业问题而不是技术问题</a> 。</p>
<p>本文的工具安装以 Linux 为例，其它平台详见 <a href="http://reactnative.cn/docs/0.27/getting-started.html" target="_blank" rel="noopener noreferrer">开始使用React Native - react native 中文网</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装-nodejs-及其自带的包下载工具-npm">安装 node.js 及其自带的包下载工具 npm<a href="#安装-nodejs-及其自带的包下载工具-npm" class="hash-link" aria-label="Direct link to 安装 node.js 及其自带的包下载工具 npm" title="Direct link to 安装 node.js 及其自带的包下载工具 npm" translate="no">​</a></h2>
<p>从 <a href="https://nodejs.org/dist/" target="_blank" rel="noopener noreferrer">nodejs 官网</a> 下载安装。 React Native 的某些 0.6x 版本还能在 nodejs v10 上面工作，更高的则至少需要 nodejs v15（nodejs 从 v16 开始不能再正常运行于 Win7 ）。</p>
<p>如果是 Linux 用户，需要手动将 node 安装位置的 <code>bin</code> 目录添加到 <code>$PATH</code> 中。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置-npm-镜像">配置 npm 镜像<a href="#配置-npm-镜像" class="hash-link" aria-label="Direct link to 配置 npm 镜像" title="Direct link to 配置 npm 镜像" translate="no">​</a></h3>
<p>为避免后续执行 <code>npm install</code> 时因网络问题导致的下载失败，最好是配置一下镜像：</p>
<p>npm config set registry <a href="https://registry.npm.taobao.org" target="_blank" rel="noopener noreferrer">https://registry.npm.taobao.org</a></p>
<p>或是暂时让电脑进行系统性翻墙比如运行翻墙 VPN 或是在系统代理设置中设置翻墙服务器的代理 <code>IP:port</code></p>
<p>或是暂时让电脑只在 <code>npm install</code> 时才翻墙，也就是在 <code>~/.npmrc</code> 中添加</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //timeout=200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https-proxy=http://翻墙服务器的代理IP:port</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装-watchman">安装 watchman<a href="#安装-watchman" class="hash-link" aria-label="Direct link to 安装 watchman" title="Direct link to 安装 watchman" translate="no">​</a></h2>
<p>watchman 是由 Facebook 提供的监视文件系统变更的工具。安装此工具可以提高开发时的性能（ React Native 的 packager 可以快速捕捉文件的变化从而实现实时刷新）</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装依赖">安装依赖<a href="#安装依赖" class="hash-link" aria-label="Direct link to 安装依赖" title="Direct link to 安装依赖" translate="no">​</a></h3>
<p>sudo apt-get install autoconf automake python-dev libtool pkg-config libssl-dev</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装-watchman-如果出错-查看安装依赖的详细文档">安装 watchman, 如果出错, 查看安装依赖的详细文档<a href="#安装-watchman-如果出错-查看安装依赖的详细文档" class="hash-link" aria-label="Direct link to 安装 watchman, 如果出错, 查看安装依赖的详细文档" title="Direct link to 安装 watchman, 如果出错, 查看安装依赖的详细文档" translate="no">​</a></h3>
<p>git clone <a href="https://github.com/facebook/watchman.git" target="_blank" rel="noopener noreferrer">https://github.com/facebook/watchman.git</a>
cd watchman
git checkout v4.6.0  # 也可以是其它的最新版本号
./autogen.sh
./configure
make
sudo make install</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装-flow">安装 flow<a href="#安装-flow" class="hash-link" aria-label="Direct link to 安装 flow" title="Direct link to 安装 flow" translate="no">​</a></h2>
<p>flow 是一个静态的 js 类型检查工具。你在很多示例中看到的奇奇怪怪的冒号问号，以及方法参数中像类型一样的写法，都是属于这个 flow 工具的语法。这一语法并不属于 ES 标准，只是 Facebook 自家的代码规范。所以新手可以直接跳过（即不需要安装这一工具，也不建议去费力学习 flow 相关语法）。</p>
<p>在终端中输入以下命令来安装flow:</p>
<p>npm install -g flow-bin</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="项目名称限制">项目名称限制<a href="#项目名称限制" class="hash-link" aria-label="Direct link to 项目名称限制" title="Direct link to 项目名称限制" translate="no">​</a></h2>
<p>项目名称中不能有 - 这个符号。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装-react-native-cli">安装 react-native-cli<a href="#安装-react-native-cli" class="hash-link" aria-label="Direct link to 安装 react-native-cli" title="Direct link to 安装 react-native-cli" translate="no">​</a></h2>
<p>npm install -g react-native-cli</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建-react-native-项目">创建 react-native 项目<a href="#创建-react-native-项目" class="hash-link" aria-label="Direct link to 创建 react-native 项目" title="Direct link to 创建 react-native 项目" translate="no">​</a></h2>
<p>比如项目名称为 AwesomeProject ：</p>
<p>react-native init AwesomeProject</p>
<p>这会自动创建 AwesomeProject 目录及其中一些文件。</p>
<p>从 react 15.3.0 开始，容易在应用的界面上引发巨量的 warning &quot;You are manually calling a React.PropTypes validation&quot; ，而且这些 warning 在 react 16 中将会变成 error ，在其它一些 react-native 第三方库解决这些问题（能使用 react 16 了）之前，可以先只用 react 15.2.1 ，所以可以指定安装依赖于 react 15.2.1 的最后一个 react-native 版本 0.31.0 ：</p>
<p>react-native init --version 0.31.0 AwesomeProject</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置-android-开发环境">配置 Android 开发环境<a href="#配置-android-开发环境" class="hash-link" aria-label="Direct link to 配置 Android 开发环境" title="Direct link to 配置 Android 开发环境" translate="no">​</a></h2>
<p>从 <a href="https://developer.android.com/studio#cmdline-tools" target="_blank" rel="noopener noreferrer">https://developer.android.com/studio#cmdline-tools</a> 下载 Command line tools 成为比如 <code>~/tools/android_sdk/cmdline-tools/latest/</code> ，在 <code>~/.bashrc</code> 中添加 <code>export ANDROID_HOME=~/tools/android-sdk</code> 。后续在编译各种 APP 时 <code>~/tools/android-sdk/cmdline-tools/latest/bin/sdkmanager</code> 会视需要自动下载比如 <code>~/tools/android-sdk/platforms/android-26/</code> 等，如果在自动下载时出现 &quot;You have not accepted the license agreements of the following SDK components&quot; 的错误，则需手动运行一下 <code>yes | ~/tools/android-sdk/cmdline-tools/latest/bin/sdkmanager --licenses</code> 。</p>
<p>为了让 android-sdk 中 32 位的 aapt (比如 <code>~/tools/android-sdk/build-tools/26.0.0/aapt</code> ) 能够在 64 位的 Linux 中运行，还要确保已经运行过如下命令：</p>
<p>sudo apt install lib32stdc++6 lib32z1</p>
<p>如果没有装过 jdk 的话，还需要：</p>
<p>sudo apt install default-jdk</p>
<p>或是到 <a href="https://jdk.java.net/archive/" target="_blank" rel="noopener noreferrer">https://jdk.java.net/archive/</a> 手动下载所需 JDK 版本并配置好<code>JAVA_HOME</code> 这个环境变量。</p>
<p>低于 0.67 版本的 React Native 需要 JDK 1.8 版本（官方也称 8 版本），否则需要 11 版本。</p>
<p>如果 <code>echo $SHELL</code> 发现是 dash 的话，后续编译时会报 <code>aapt: Syntax error: newline unexpected (expecting &quot;)&quot;</code> 的错误，所以还需换成 bash：</p>
<p>sudo dpkg-reconfigure dash</p>
<p>如果是 Win10 中的 WSL ，后续编译时会报 <code>aapt: cannot execute binary file: Exec format error</code> 的错误，这是由于 <a href="https://wpdev.uservoice.com/forums/266908-command-prompt-console-bash-on-ubuntu-on-windo/suggestions/13377507-please-add-32-bit-elf-support-to-the-kernel" target="_blank" rel="noopener noreferrer">64 位的 Win10 只支持 64 位而不支持 32 位的 Linux 二进制可执行文件</a> ，解决方法是先</p>
<p>sudo apt install qemu-user</p>
<p>然后以 <code>~/tools/android-sdk/build-tools/23.0.1/aapt</code> 为例，把 aapt 重命名为 aapt-32 ，最后原地新建可执行脚本文件 aapt ，脚本内容为 <code>qemu-i386 ~/tools/android-sdk/build-tools/23.0.1/aapt-32 $*</code> 即可。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="debug-在线运行-android">debug 在线运行 Android<a href="#debug-在线运行-android" class="hash-link" aria-label="Direct link to debug 在线运行 Android" title="Direct link to debug 在线运行 Android" translate="no">​</a></h2>
<p>在 react-native 项目目录比如 <code>AwesomeProject/</code> 中用如下命令自动编译 apk 并运行：</p>
<p>react-native run-android</p>
<p>它也会同时启动 native packager server , 如果没有自动启动 server , 会报错 <code>React Native: ReferenceError: Can&#x27;t find variable: require (line 1 in the generated bundle)</code> ，此时就需要手动启动：</p>
<p>react-native start</p>
<p>这样，当 js 代码修改后，将 Android 真机摇一摇，就能 Reload 过来最新修改的 js 代码了。背后的动作实际上是在 Reload 的时候 packager server 实时生成了一个 <code>index.android.bundle</code> 被下载到 Android APP 中。 react native 的 LogBox 也就是出错时或 <code>console.warn</code> 在 APP 界面上的打印信息中有指明文件名和行数，如果文件名是 <code>index.android.bundle</code> 的话，则可以比如用 <code>wget http://localhost:8081/index.android.bundle</code> 命令下载到电脑中查看，此时需要注意的是不要下载到你启动 <code>react-native start</code> 的目录中比如 <code>YOUR_PROJECT/index.android.bundle</code> ，否则后续你对代码的更改再也不会被打包为最新的 <code>index.android.bundle</code> 因为 <code>packager server</code> 此时就像一个 web server 一样直接将现存的 <code>YOUR_PROJECT/index.android.bundle</code> 提供给 Android APP 或 wget 。</p>
<p>如果 <code>react-native run-android</code> 出现错误提示 “java.util.concurrent.ExecutionException: com.android.builder.utils.SynchronizedFile$ActionExecutionException: com.android.ide.common.signing.KeytoolException: Failed to create keystore.” ，则需要</p>
<p>keytool -genkey -v -keystore debug.keystore -storepass android -alias androiddebugkey -keypass android -keyalg RSA -keysize 2048 -validity 10000</p>
<p>并将生成的 debug.keystore 放到 <code>~/.android/</code> 中。</p>
<p>如果 <code>react-native run-android</code> 时因网络问题导致 gradle 这个编译工具自身都下载失败，则可以暂时让电脑进行系统性翻墙比如运行翻墙 VPN 或是在系统代理设置中设置翻墙服务器的代理 <code>IP:port</code> ，或是在此时会发现新生成了一个目录比如 <code>~/.gradle/wrapper/dists/gradle-6.2-all/dvufqs6kielxeao781pmk5huj/</code> ，你可以删除该目录中的 <code>gradle-6.2-all.zip.part.0</code> ，然后在可以翻墙的浏览器中下载 <code>android/gradle/wrapper/gradle-wrapper.properties</code> 中的 <code>services.gradle.org/distributions/gradle-6.2-all.zip</code> 文件到该目录中，最后重新 <code>react-native run-android</code> 即可，或者干脆使用镜像地址 <code>mirrors.cloud.tencent.com/gradle/gradle-6.2-all.zip</code> 替换进 <code>gradle-wrapper.properties</code> 中。</p>
<p>如果 <code>react-native run-android</code> 时因网络问题导致 gradle 这个编译工具报出一些第三方库下载失败，则可以暂时让电脑进行系统性翻墙比如运行翻墙 VPN 或是在系统代理设置中设置翻墙服务器的代理 <code>IP:port</code> ，或是暂时让电脑只在运行 gradle 时才翻墙，也就是在 <code>~/.gradle/gradle.properties</code> 中添加</p>
<p>systemProp.https.proxyHost=翻墙服务器的代理IP
systemProp.https.proxyPort=翻墙服务器的代理port</p>
<p>或是在 <code>build.gradle</code> 中添加下面镜像仓库地址之一</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    maven { url &#x27;https://mirrors.cloud.tencent.com/nexus/repository/maven-public/&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    maven { url &#x27;https://mirrors.163.com/maven/repository/maven-public/&#x27;}</span><br></span></code></pre></div></div>
<p>如果 <code>react-native start</code> 出现错误提示 “increase the fs.inotify.max_user_watches sysctl” ，则可按 <a href="https://github.com/guard/listen/wiki/Increasing-the-amount-of-inotify-watchers" target="_blank" rel="noopener noreferrer">Increasing the amount of inotify watchers</a> 进行操作。</p>
<p>上面的 <code>react-native run-android</code> 实际上执行的命令是 <code>./android/gradlew installDebug -p ./android/</code> ，这个命令每次执行时都会尝试从网上下载一些第三方组件的最新版。可以根据自己的实际情况优化这个命令，比如不想每次都尝试网上下载而是离线编译时添加 <code>--offline</code> ，就像这个命令 <code>./android/gradlew installDebug --offline -x lint -x lintVitalRelease -p ./android/</code> 中做的那样，不过当离线编译出现比如</p>
<p>Could not resolve com.android.tools.lint:lint-gradle:26.5.3</p>
<p>这样错误时，就需要临时去掉 <code>--offline</code> 来运行一次。</p>
<p>如果 APP 启动就闪退出现，并且 logcat 中有错误提示 “java.lang.UnsatisfiedLinkError: couldn&#x27;t find DSO to load: libfbjni.so result: 0” ，则需要 <code>./android/gradlew assembleDebug --rerun-tasks -p ./android/</code> 或者是 <code>./android/gradlew clean -p ./android/; react-native run-android; react-native start --reset-cache</code> 。</p>
<p>如果是 Win10 中的 WSL ，由于 Windows 的防火墙无法自动在 WSL 中的 Linux 开启端口时弹出对话框让用户选择是否允许，所以只有 Win10 本机才能访问该端口。为了让其它主机比如 Android 真机摇一摇后 <code>Dev Setting | Debug server host &amp; port for device</code> 设置能够成功 Reload 到 js 代码，需要手动在防火墙中开启 native packager server 所监听的 8081 端口，方法是在 <code>控制面板 | Windows Defender 防火墙 | 高级安全 Windows Defender 防火墙 | 入站规则 | 新建规则</code> 中选择 <code>端口 | 8081 | 允许连接 </code> ，最后填写名称比如为 <code>Allow localhost port 8081</code> 以及填写描述比如为 <code>port forwarding to allow external machine to access Windows 10&#x27;s Windows Subsystem Linux servers</code> 即可。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-离线打包-android">release 离线打包 Android<a href="#release-离线打包-android" class="hash-link" aria-label="Direct link to release 离线打包 Android" title="Direct link to release 离线打包 Android" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成签名库拷贝至-androidapp">生成签名库,拷贝至 android/app/<a href="#生成签名库拷贝至-androidapp" class="hash-link" aria-label="Direct link to 生成签名库,拷贝至 android/app/" title="Direct link to 生成签名库,拷贝至 android/app/" translate="no">​</a></h3>
<p>keytool -genkey -v -keystore rn-apk.keystore -alias rn-apk -keyalg RSA -keysize 2048 -validity 10000</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="设置全局变量-gradlegradleproperties">设置全局变量 <code>~/.gradle/gradle.properties</code><a href="#设置全局变量-gradlegradleproperties" class="hash-link" aria-label="Direct link to 设置全局变量-gradlegradleproperties" title="Direct link to 设置全局变量-gradlegradleproperties" translate="no">​</a></h3>
<p>MYAPP_RELEASE_STORE_FILE=rn-apk.keystore
MYAPP_RELEASE_KEY_ALIAS=rn-apk
MYAPP_RELEASE_STORE_PASSWORD=130777
MYAPP_RELEASE_KEY_PASSWORD=130777</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="更改-androidappbuildgradle">更改 android/app/build.gradle<a href="#更改-androidappbuildgradle" class="hash-link" aria-label="Direct link to 更改 android/app/build.gradle" title="Direct link to 更改 android/app/build.gradle" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    signingConfigs {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        release {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            storeFile file(MYAPP_RELEASE_STORE_FILE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            storePassword MYAPP_RELEASE_STORE_PASSWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias MYAPP_RELEASE_KEY_ALIAS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPassword MYAPP_RELEASE_KEY_PASSWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buildTypes {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        release {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signingConfig signingConfigs.release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成-apk">生成 apk<a href="#生成-apk" class="hash-link" aria-label="Direct link to 生成 apk" title="Direct link to 生成 apk" translate="no">​</a></h3>
<p>cd android
./gradlew assembleRelease</p>
<p>如果在此过程中报出 <code>Out of Memory Error</code> 的错误，则需要在 <code>~/.gradle/gradle.properties</code> 中添加类似如下内容：</p>
<p>org.gradle.jvmargs=-Xmx2048m -XX<!-- -->:MaxPermSize<!-- -->=512m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8</p>
<p>更多用法参见 <a href="http://alihub.org/14659907331638.html" target="_blank" rel="noopener noreferrer">React-Native 离线打包</a> 。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成-aab">生成 aab<a href="#生成-aab" class="hash-link" aria-label="Direct link to 生成 aab" title="Direct link to 生成 aab" translate="no">​</a></h3>
<p>./android/gradlew bundleRelease --offline -x lint -x lintVitalRelease -p ./android/</p>
<p>如果生成好的 aab 在上传到 Google Play 时报错说“您上传的 APK 或 Android App Bundle 内含活动、活动别名、服务或广播接收器，这些项目有 intent 过滤器，但没有“android<!-- -->:exported<!-- -->”属性设置。此文件无法在 Android 12 或更高版本上安装”，且将自己 APP 的 <code>android:exported</code> 设为 true 后仍然如此，则将 <code>compileSdkVersion</code> 设为 31 再次进行编译时就可以依据 <a href="https://github.com/facebook/react-native/issues/35232#issuecomment-1324619149" target="_blank" rel="noopener noreferrer">Apps targeting Android 12 and higher are required to specify an explicit value for android<!-- -->:exported<!-- --> when the corresponding component has an intent filter defined. See https://developer.android.com/guide/topics/manifest/activity-element#exported for details</a> 中所说的错误定位到某个第三方组件了。</p>
<p>如果将 <code>compileSdkVersion</code> 设为 31 后编译时碰到 <code>Installed Build Tools revision 31.0.0 is corrupted</code> 错误，则需要从低版本比如 <code>android-sdk/build-tools/30.0.0/</code> 中复制出 <code>d8</code> 和 <code>d8.jar</code> 来，或是参考 <a href="https://stackoverflow.com/a/68430992/6318705" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/a/68430992/6318705</a></p>
<p>cd ~/tools/android-sdk/build-tools/31.0.0
mv d8 dx <br>
<!-- -->cd lib  <br>
<!-- -->mv d8.jar dx.jar</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-在线更新热更新">release 在线更新（热更新）<a href="#release-在线更新热更新" class="hash-link" aria-label="Direct link to release 在线更新（热更新）" title="Direct link to release 在线更新（热更新）" translate="no">​</a></h2>
<p>参见 <a href="https://segmentfault.com/a/1190000009642563" target="_blank" rel="noopener noreferrer">React Native CodePush实践小结</a> 。</p>
<p>针对后端 API 版本更新问题，在网上搜了一圈罗列在下面，可以发现公说公有理、婆说婆有理，我觉得还不如统一使用最简单的 react-native 前端热更新。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">对于实在没有办法需要全面升级接口的。如果可能，保持原有的业务、原有的接口运转正常。然后构建一套全新的隔离的接口。最后做下版本使用监控。当观察到所有用户都使用新版本的客户端的时候，并保持一段时间的时候。放弃对老版本的维护，继而下掉老版本的资源。当然，万不得已的时候，还可以用强制更新。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">有的公司，每次发布完 APP ，就强制用户更新到最新版本。不推荐这样，因为用户体验太差。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">就算是用强制更新，在苹果审核期间，新的 APP 接口和老的接口也必须能同时使用。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">一般向下兼容 2 个版本。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果贵司的 API 是公开的，供第三方开发者使用的话，请一定记着维持兼容性，不然每次升级都大改的话，开发者只会怀疑你们一开始就没设计好，然后就没人用了。这种情况给开发者一个缓冲阶段，让他们在期限前升级到新版本，然后就可以放弃旧版本了。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果仅供自己使用的话，要求用户强制升级，旧版本直接扔掉就行了。</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装-react-dom">安装 react-dom<a href="#安装-react-dom" class="hash-link" aria-label="Direct link to 安装 react-dom" title="Direct link to 安装 react-dom" translate="no">​</a></h2>
<p>安装后续要安装的 react-native-web 或 react-web 的 package.json 中的 <code>peerDependencies</code> 里的 <code>react</code> 和 <code>react-dom</code>，因为 react-native-web 或 react-web 相当于是 <code>react</code> 和 <code>react-dom</code> 这两个宿主的插件，想要装插件就要先装宿主。由于上面 <code>react-native init</code> 已经自动安装了 react ，所以现在只需安装 react-dom ：</p>
<p>cd AwesomeProject
npm install react-dom --save</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rn--060-的安装-react-native-web">RN &gt;= 0.60 的安装 react-native-web<a href="#rn--060-的安装-react-native-web" class="hash-link" aria-label="Direct link to RN &gt;= 0.60 的安装 react-native-web" title="Direct link to RN &gt;= 0.60 的安装 react-native-web" translate="no">​</a></h2>
<p>npm install react-native-web
npm install react-app-rewired react-error-overlay@6.0.9 --save-dev</p>
<p>(<code>react-error-overlay@6.0.10</code> will cause <code>Uncaught ReferenceError: process is not defined</code> when hot reloading)</p>
<ul>
<li>Create <code>web/aliases/react-native/index.js</code>:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ref to https://levelup.gitconnected.com/react-native-typescript-and-react-native-web-an-arduous-but-rewarding-journey-8f46090ca56b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {Text as RNText, Image as RNImage} from &#x27;react-native-web&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// import RNModal from &#x27;modal-enhanced-react-native-web&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Let&#x27;s export everything from react-native-web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export * from &#x27;react-native-web&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// And let&#x27;s stub out everything that&#x27;s missing!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export const ViewPropTypes = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  style: () =&gt; {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RNText.propTypes = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  style: () =&gt; {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RNImage.propTypes = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  style: () =&gt; {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  source: () =&gt; {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export const Text = RNText;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export const Image = RNImage;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// export const Modal = RNModal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// export const ToolbarAndroid = {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export const requireNativeComponent = () =&gt; {};</span><br></span></code></pre></div></div>
<ul>
<li>Create <code>public/index.html</code>:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;title&gt;React App&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html; charset=utf-8&quot;/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /* These styles make the body full-height */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      html,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      body {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        height: 100%;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /* These styles disable body scrolling if you are using &lt;ScrollView&gt; */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      body {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        overflow: hidden;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /* These styles make the root element full-height */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      #root {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        display: flex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        height: 100%;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre></div></div>
<ul>
<li>
<p>Modify <code>&quot;index&quot;</code> into <code>&quot;index.android&quot;</code> in <code>android/app/src/main/java/com/yourprojectname/MainApplication.java</code></p>
</li>
<li>
<p>Modify <code>@&quot;index&quot;</code> into <code>@&quot;index.ios&quot;</code> in <code>/ios/YourProjectName/AppDelegate.m</code></p>
</li>
<li>
<p>Modify</p>
</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    shellScript = &quot;export NODE_BINARY=node\n../node_modules/react-native/scripts/react-native-xcode.sh&quot;;</span><br></span></code></pre></div></div>
<p>into</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    shellScript = &quot;export NODE_BINARY=node\nexport ENTRY_FILE=index.ios.js\n../node_modules/react-native/scripts/react-native-xcode.sh\n&quot;;</span><br></span></code></pre></div></div>
<p>in <code>ios/PixelShapeRN.xcodeproj/project.pbxproj</code></p>
<ul>
<li>Create <code>index.android.js</code> and <code>index.ios.js</code>:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// because index.android.js or index.ios.js can worked in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// react-native-code-push@5.2.0 and bugsnag-react-native@2.5.1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// but not index.native.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {AppRegistry} from &#x27;react-native&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import App from &#x27;./src/index.js&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {name as appName} from &#x27;./app.json&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AppRegistry.registerComponent(appName, () =&gt; App);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="react-scripts3"><code>react-scripts@3</code><a href="#react-scripts3" class="hash-link" aria-label="Direct link to react-scripts3" title="Direct link to react-scripts3" translate="no">​</a></h3>
<p>npm install react-scripts@3.4.3 babel-jest@24.9.0 eslint@6.6.0 jest@24.9.0 --save-dev</p>
<ul>
<li>Create <code>index.web.js</code>:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import {AppRegistry} from &#x27;react-native&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import App from &#x27;./src/index.js&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {name as appName} from &#x27;./app.json&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AppRegistry.registerComponent(appName, () =&gt; App);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AppRegistry.runApplication(appName, {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rootTag: document.getElementById(&#x27;root&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre></div></div>
<ul>
<li>Create <code>config-overrides.js</code> in your project root:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// used by react-app-rewired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const webpack = require(&#x27;webpack&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const path = require(&#x27;path&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.exports = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  webpack: function (config, env) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // To enable the eslint rules in &#x27;.eslintrc.js&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.module.rules[1].use[0].options.baseConfig.extends = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      path.resolve(&#x27;.eslintrc.js&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // To avoid sometimes react-app-rewired is not honouring your change to the eslint rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // in &#x27;.eslintrc.js&#x27;, you should manually disable the eslint cache, ref to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // https://github.com/facebook/create-react-app/issues/9007#issuecomment-628601097</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.module.rules[1].use[0].options.cache = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // To enable &#x27;.eslintignore&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.module.rules[1].use[0].options.ignore = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // To let alias like &#x27;react-native/Libraries/Components/StaticRenderer&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // take effect, must set it before alias &#x27;react-native&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delete config.resolve.alias[&#x27;react-native&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.resolve.alias[&#x27;react-native/Libraries/Components/StaticRenderer&#x27;] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;react-native-web/dist/vendor/react-native/StaticRenderer&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.resolve.alias[&#x27;react-native&#x27;] = path.resolve(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;web/aliases/react-native&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Let&#x27;s force our code to bundle using the same bundler react native does.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.plugins.push(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      new webpack.DefinePlugin({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __DEV__: env === &#x27;development&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Keep all rules except the eslint - note that if they add additional rules this will need updating to match</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Consider if this should only apply to the development environment? If so, uncomment the if statement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // if (env === &#x27;development&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //   config.module.rules.splice(1, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Need this rule to prevent `Attempted import error: &#x27;SOME&#x27; is not exported from` when `react-app-rewired build`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Need this rule to prevent `TypeError: Cannot assign to read only property &#x27;exports&#x27; of object` when `react-app-rewired start`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config.module.rules.push({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      test: /\.(js|tsx?)$/,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // You can exclude the exclude property if you don&#x27;t want to keep adding individual node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // just keep an eye on how it effects your build times, for this example it&#x27;s negligible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // exclude: /node_modules[/\\](?!@react-navigation|react-native-gesture-handler|react-native-screens)/,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      use: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loader: &#x27;babel-loader&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return config;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  paths: function (paths, env) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths.appIndexJs = path.resolve(&#x27;index.web.js&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths.appSrc = path.resolve(&#x27;.&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths.moduleFileExtensions.push(&#x27;ios.js&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths.moduleFileExtensions.push(&#x27;android.js&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths.moduleFileExtensions.push(&#x27;native.js&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return paths;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<ul>
<li>Add below into <code>package.json</code>:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;scripts&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;web&quot;: &quot;react-app-rewired start&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;build-web&quot;: &quot;react-app-rewired build&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre></div></div>
<ul>
<li>Use <code>npm run web</code> for development, then view it at <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000</a> in web browser</li>
<li>Use <code>npm run build-web</code> to generate files in <code>build/</code> for production, and can use <code>npx http-server@13.0.2 build</code> to simply test it at <a href="http://127.0.0.1:8080" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080</a> in web browser.</li>
</ul>
<p>If some error like below in shell, then you should refactor those lint <code>Line</code>, or enable <code>config.module.rules.splice(1, 1);</code> in <code>config-overrides.js</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Failed to compile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Line 11:25:   Insert `,`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettier/prettier</span><br></span></code></pre></div></div>
<p>And since there is webpack config <code>loader: &#x27;babel-loader&#x27;</code> here, maybe need add some in <code>babel.config.js</code> ref to APP ReactWebNative8Koa <a href="https://github.com/flyskywhy/ReactWebNative8Koa/commit/a87437ad0527edaa4a2f643708938accabb26a8d" target="_blank" rel="noopener noreferrer">RN 0.63.2 -&gt; 0.70.5: works well on Web</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-to-react-scripts5-and-add-web-workers-support">Upgrade to <code>react-scripts@5</code> and Add Web Workers support<a href="#upgrade-to-react-scripts5-and-add-web-workers-support" class="hash-link" aria-label="Direct link to upgrade-to-react-scripts5-and-add-web-workers-support" title="Direct link to upgrade-to-react-scripts5-and-add-web-workers-support" translate="no">​</a></h3>
<p>At the very first, after upgrade react-scripts from 3 to 5 and related babel upgrade (or modify webpack config?), the most important thing is <code>rm -fr node_modules/.cache/*</code> first, otherwise will meet many strange error and can&#x27;t be solved.</p>
<p>npm install react-app-rewired@2.2.1 react-scripts@5.0.0 codegen.macro react-refresh@0.11.0 react-error-overlay@6.0.9 --save-dev</p>
<p>(lower version of <code>react-refresh</code> comes from <code>metro-react-native-babel-preset</code> may cause <code>Module not found: Error: Cannot find module &#x27;react-refresh&#x27;</code>)</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-in-packagejson">Upgrade in <code>package.json</code><a href="#upgrade-in-packagejson" class="hash-link" aria-label="Direct link to upgrade-in-packagejson" title="Direct link to upgrade-in-packagejson" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;scripts&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;web&quot;: &quot;PLATFORM_OS=web DISABLE_ESLINT_PLUGIN=true react-app-rewired start&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;web-fresh&quot;: &quot;rm -fr node_modules/.cache/*; PLATFORM_OS=web DISABLE_ESLINT_PLUGIN=true react-app-rewired start&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;build-web&quot;: &quot;PLATFORM_OS=web DISABLE_ESLINT_PLUGIN=true react-app-rewired build&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;build-web-PixelShapeRN&quot;: &quot;PUBLIC_URL=/PixelShapeRN PLATFORM_OS=web DISABLE_ESLINT_PLUGIN=true react-app-rewired build&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre></div></div>
<ul>
<li>Use <code>npm run web</code> for development, then view it at <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000</a> in web browser.</li>
<li>Use <code>npm run web-fresh</code> for development to automatically <code>rm -fr node_modules/.cache/*</code> first.</li>
<li>Use <code>npm run build-web</code> to generate files in <code>build/</code> for production, and can use <code>npx http-server@13.0.2 build</code> to simply test it at <a href="http://127.0.0.1:8080" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080</a> in web browser.</li>
</ul>
<p><code>PUBLIC_URL=/PixelShapeRN</code> here is to <a href="https://github.com/flyskywhy/PixelShapeRN/commit/6f5ce184c8d5cfbaee596a3ec8169bfd3c4828fb" target="_blank" rel="noopener noreferrer">fix <code>build-web-PixelShapeRN</code> <code>GET https://flyskywhy.github.io/PixelShapeRN/PixelShapeRN/static/js/main.b043a6c7.js net::ERR_ABORTED 404</code></a>, you should replace <code>PixelShapeRN</code> here with your github repo name.</p>
<p><code>DISABLE_ESLINT_PLUGIN=true</code> here is to avoid <a href="https://stackoverflow.com/questions/70397587/failed-to-load-plugin-flowtype-declared-in-package-json-eslint-config-react" target="_blank" rel="noopener noreferrer">Failed to load plugin &#x27;flowtype&#x27; declared in &#x27;package.json » eslint-config-react-app&#x27;: Cannot find module &#x27;eslint/use-at-your-own-risk&#x27;</a>.</p>
<p><code>PLATFORM_OS=web</code> here work with codegen.macro is to avoid <code>SyntaxError: import.meta is only valid inside modules.</code> with react-native, ref to &quot;import.meta.url&quot; in <code>https://github.com/flyskywhy/PixelShapeRN/blob/v1.1.27/src/workers/workerPool.js</code></p>
<p>If not define <code>DISABLE_ESLINT_PLUGIN=true</code> , and nodejs version &lt; 14 , will cause <code>ERROR in Error: Child compilation failed: Module.createRequire is not a function</code> . If define <code>DISABLE_ESLINT_PLUGIN=true</code> , then nodejs version can &lt; 14 because only <code>eslint@8</code> is using <code>Module.createRequire</code> .</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-in-config-overridesjs-indexwebjs-and-other-files">Upgrade in <code>config-overrides.js</code> <code>index.web.js</code> and other files<a href="#upgrade-in-config-overridesjs-indexwebjs-and-other-files" class="hash-link" aria-label="Direct link to upgrade-in-config-overridesjs-indexwebjs-and-other-files" title="Direct link to upgrade-in-config-overridesjs-indexwebjs-and-other-files" translate="no">​</a></h4>
<p>Ref to APP ReactWebNative8Koa <a href="https://github.com/flyskywhy/ReactWebNative8Koa/commit/8adc7bbf43d225b790de88a177aa438ccea8dabc" target="_blank" rel="noopener noreferrer">RN 0.63.2 -&gt; 0.70.5: let Web Worker with Support for CRA v5 (and Webpack 5)</a> , and your project may need <code>npm run stream-browserify process --save-dev</code> as described in <a href="https://github.com/flyskywhy/ReactWebNative8Koa/blob/8adc7bbf43d225b790de88a177aa438ccea8dabc/config-overrides.js#L25" target="_blank" rel="noopener noreferrer">config-overrides.js</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="qa">Q&amp;A<a href="#qa" class="hash-link" aria-label="Direct link to Q&amp;A" title="Direct link to Q&amp;A" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="unexpected-token-"><code>Unexpected token &#x27;&lt;&#x27;</code><a href="#unexpected-token-" class="hash-link" aria-label="Direct link to unexpected-token-" title="Direct link to unexpected-token-" translate="no">​</a></h4>
<p>If the url in web browser is <code>http://localhost:3000/Foo/Bar</code> not <code>http://localhost:3000</code>, and
<code>Uncaught SyntaxError: Unexpected token &#x27;&lt;&#x27;</code> in shell, then you need remove homepage in <code>package.json</code> like:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;homepage&quot;: &quot;https://github.com/Foo/Bar#readme&quot;,</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="npm-err-eresolve-unable-to-resolve-dependency-tree"><code>npm ERR! ERESOLVE unable to resolve dependency tree</code><a href="#npm-err-eresolve-unable-to-resolve-dependency-tree" class="hash-link" aria-label="Direct link to npm-err-eresolve-unable-to-resolve-dependency-tree" title="Direct link to npm-err-eresolve-unable-to-resolve-dependency-tree" translate="no">​</a></h4>
<p>Ref to <a href="https://github.com/flyskywhy/react-native-usb-serialport/issues/2" target="_blank" rel="noopener noreferrer">npm installation version problem</a> , you need use npm version which is below 7, or e.g.</p>
<p>npm install react-native-usb-serialport --legacy-peer-deps</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed---javascript-heap-out-of-memory"><code>FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory</code><a href="#fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed---javascript-heap-out-of-memory" class="hash-link" aria-label="Direct link to fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed---javascript-heap-out-of-memory" title="Direct link to fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed---javascript-heap-out-of-memory" translate="no">​</a></h4>
<p>If <code>npm run build-web</code> got this error, then need change</p>
<p>&quot;build-web&quot;: &quot;react-app-rewired build&quot;,</p>
<p>to</p>
<p>&quot;build-web&quot;: &quot;node --max_old_space_size=4096 node_modules/.bin/react-app-rewired build&quot;,</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-not-found-error-cant-resolve-react-nativepackagejson"><code>Module not found: Error: Can&#x27;t resolve &#x27;react-native/package.json&#x27;</code><a href="#module-not-found-error-cant-resolve-react-nativepackagejson" class="hash-link" aria-label="Direct link to module-not-found-error-cant-resolve-react-nativepackagejson" title="Direct link to module-not-found-error-cant-resolve-react-nativepackagejson" translate="no">​</a></h4>
<p>If using <code>react-native-gesture-handler@2</code> not <code>react-native-gesture-handler@1</code> will meet <code>ERROR in ./node_modules/react-native-gesture-handler/lib/module/utils.js 1:0-45</code> , then need add</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    config.resolve.alias[&#x27;react-native/package.json&#x27;] = path.resolve(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;node_modules/react-native/package.json&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span></code></pre></div></div>
<p>into <code>config-overrides.js</code> .</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cannot-find-module-ajvdistcompilecodegen"><code>Cannot find module &#x27;ajv/dist/compile/codegen&#x27;</code><a href="#cannot-find-module-ajvdistcompilecodegen" class="hash-link" aria-label="Direct link to cannot-find-module-ajvdistcompilecodegen" title="Direct link to cannot-find-module-ajvdistcompilecodegen" translate="no">​</a></h3>
<p>Need</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm install ajv@8.17.1</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="uncaught-error-cannot-find-module-react-native-playtorch"><code>Uncaught Error: Cannot find module &#x27;react-native-playtorch&#x27;</code><a href="#uncaught-error-cannot-find-module-react-native-playtorch" class="hash-link" aria-label="Direct link to uncaught-error-cannot-find-module-react-native-playtorch" title="Direct link to uncaught-error-cannot-find-module-react-native-playtorch" translate="no">​</a></h4>
<p>It maybe <code>Uncaught Error: PlayTorchJSIModule not found</code> if <code>APP/tsconfig.json</code> exist.</p>
<p>Fix it by:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-import {Camera, Canvas} from &#x27;react-native-playtorch&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+if (Platform.OS !== &#x27;web&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+  var {Camera, Canvas} = require(&#x27;react-native-playtorch&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="warning-module-not-found-error-cant-resolve-react-native-pytorch-core">warning <code>Module not found: Error: Can&#x27;t resolve &#x27;react-native-pytorch-core&#x27;</code><a href="#warning-module-not-found-error-cant-resolve-react-native-pytorch-core" class="hash-link" aria-label="Direct link to warning-module-not-found-error-cant-resolve-react-native-pytorch-core" title="Direct link to warning-module-not-found-error-cant-resolve-react-native-pytorch-core" translate="no">​</a></h4>
<p>If use a pure ts package e.g. <code>&quot;react-native-pytorch-core&quot;: &quot;git+https://github.com/flyskywhy/playtorch#CameraModule&quot;</code> which only has <code>src/</code> but no <code>lib/</code>, then need <code>npm install @tsconfig/react-native@2.0.2</code> and create <code>APP/tsconfig.json</code> with the content</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;extends&quot;: &quot;@tsconfig/react-native/tsconfig.json&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>thus <code>const useTypeScript = fs.existsSync(paths.appTsConfig)</code> in <code>node_modules/react-scripts/config/webpack.config.js</code> can be <code>true</code>, and patch by</p>
<p>sed -i -e &quot;s/lib/commonjs/src/&quot; node_modules/react-native-pytorch-core/package.json</p>
<p>PS: There is already <code>&quot;react-native&quot;: &quot;src/index&quot;</code> in <code>react-native-pytorch-core/package.json</code>, so metro of react native already works fine without the patch.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rn--060-的安装-react-web">RN &lt; 0.60 的安装 react-web<a href="#rn--060-的安装-react-web" class="hash-link" aria-label="Direct link to RN &lt; 0.60 的安装 react-web" title="Direct link to RN &lt; 0.60 的安装 react-web" translate="no">​</a></h2>
<p>npm install -g react-web-cli</p>
<p>在项目根目录的上层目录中创建 react-web 项目</p>
<p>cd ..
react-web init AwesomeProject</p>
<p>因官方 react-web 已停止维护，所以接下来可使用我维护的仓库替代</p>
<p>cd AwesomeProject
npm uninstall react-web
npm install <a href="https://github.com/flyskywhy/react-web.git#f6c63e3" target="_blank" rel="noopener noreferrer">https://github.com/flyskywhy/react-web.git#f6c63e3</a></p>
<p>在项目根目录中运行如下命令即可启动 webpack 调试服务器，然后在浏览器打开 localhost:3000 即可：</p>
<p>react-web start</p>
<p>坑：有时修改了 js 文件但是 webpack 调试服务器没有自动重新 bundle ，这个 BUG 可以通过重启电脑解决。</p>
<p>其它可参见 <a href="http://taobaofed.org/blog/2016/03/11/react-web-intro/" target="_blank" rel="noopener noreferrer">三步将 React Native 项目运行在 Web 浏览器上面</a></p>
<p>在项目根目录中运行如下命令即可打包 Web 到 <code>web/output/</code> 目录中</p>
<p>react-web bundle</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置-ios-开发环境">配置 iOS 开发环境<a href="#配置-ios-开发环境" class="hash-link" aria-label="Direct link to 配置 iOS 开发环境" title="Direct link to 配置 iOS 开发环境" translate="no">​</a></h2>
<p>除了为 React Native <a href="https://reactnative.cn/docs/environment-setup.html" target="_blank" rel="noopener noreferrer">搭建开发环境</a> ，还需 <a href="https://sspai.com/post/42924" target="_blank" rel="noopener noreferrer">像 Mac 高手一样管理应用，从 Homebrew 开始</a> 使用 <code>brew install</code> 或 <code>mas install</code> 安装各种实用工具。安装过程中最好保持翻墙状态，否则速度较慢或无法安装。另可参考 <a href="https://www.cnblogs.com/imzhizi/p/my-apps-on-mac.html" target="_blank" rel="noopener noreferrer">我在 Mac 上都用什么</a> 以及 <a href="/g/docs/i主观的体验方式/t快乐的体验/电信/Os/macOS/macOS使用详解">macOS使用详解</a> 。</p>
<p>brew install mas node watchman dos2unix mosh
brew install sublime-text double-commander google-chrome the-unarchiver iterm2 xquartz typora meld intelliscape-caffeine bitbar geektool turbovnc-viewer microsoft-remote-desktop flux inkscape gimp</p>
<p>注：其中 <code>turbovnc-viewer</code> 的运行需要先安装下面提到的 JAVA 环境，并在 macOS 自带终端中运行(在 iterm2 中运行没有效果)如下语句：</p>
<p>export JAVA_HOME=<code>/usr/libexec/java_home -v 1.8</code>
launchctl setenv JAVA_HOME $JAVA_HOME</p>
<ul>
<li>升级 node 的方法</li>
</ul>
<p>可以采用如下方法升级到比如 v16 版本：</p>
<p>brew install node@16</p>
<p>然后在 <code>~/.zshrc</code> 或 <code>~/.bash_profile</code> 中添加如下语句并重启电脑：</p>
<p>export PATH=/usr/local/opt/node@16/bin:$PATH</p>
<p>最后在运行比如 <code>react-native start</code> 之前开发者有时想要运行的 <code>watchman watch-del-all</code> 过程中出现类似</p>
<p>dyld[23087]:  Library not loaded: /usr/local/opt/icu4c/lib/libicudata.71.dylib
Referenced from: /usr/local/Cellar/boost/1.79.0_2/lib/libboost_regex-mt.dylib
sh: line 1: 23087 Abort trap: 6           watchman watch-del-all</p>
<p>这样的报错，则需要：</p>
<p>brew upgrade</p>
<p>来自动升级 boost 到最新版。</p>
<p>另，在 Xcode 打包 release 时会调用 <code>/usr/local/bin/node</code> ，所以还需要：</p>
<p>ln -sf $(which node) /usr/local/bin/node</p>
<ul>
<li>解决 <code>brew install</code> 或 <code>npm install -g</code> 时出现的 <code>/usr/local/</code> 权限问题</li>
</ul>
<p>如果当前不是 macOS 的第一个用户，就算已加入 admin 组，也还需要手动加入 wheel 组：</p>
<p>sudo dseditgroup -o edit -a $USER -t user wheel</p>
<ul>
<li>解决 <code>brew install</code> 卡住很久的问题</li>
</ul>
<p>brew 在安装软件前会先尝试升级 brew 自身，这里可能是中国网络环境的原因而会卡住很久，如果不想要升级 brew 自身的，此时可以直接 <code>CTRL + C</code> 跳过，它就会自动继续去安装了。</p>
<ul>
<li>解决 <code>brew install</code> 的 git-gui 运行时容易崩溃或是 gitk 无法调出鼠标右键菜单的问题</li>
</ul>
<p>使用其它 git 的图形化客户端替代，比如</p>
<p>brew install fork</p>
<ul>
<li>解决 <code>brew install</code> 时出现的 <code>Error: Your CLT does not support macOS 11.2.</code> 问题</li>
</ul>
<p>该错误一般是因为 macOS 升级了但 Xcode 的 <code>Command Line Tools</code> 还没有匹配更新。该错误有时也会表现为 <code>Error: Your Xcode does not support macOS 11.2.</code> 的形式。解决方法为：</p>
<p>sudo rm -rf /Library/Developer/CommandLineTools
sudo xcode-select --install</p>
<p>如果错误依旧，则：</p>
<p>sudo rm -rf /Library/Developer/CommandLineTools</p>
<p>之后，再去 <a href="https://developer.apple.com/download/more/" target="_blank" rel="noopener noreferrer">https://developer.apple.com/download/more/</a> 下载安装最新的 <code>Command Line Tools</code> 。</p>
<ul>
<li>安装 JAVA 环境</li>
</ul>
<p>如果想在 macOS 上编译 Android APP ，则还需参考 <a href="https://reactnative.dev/docs/0.70/environment-setup?guide=native&amp;os=macos" target="_blank" rel="noopener noreferrer">https://reactnative.dev/docs/0.70/environment-setup?guide=native&amp;os=macos</a> 一文安装 JDK11</p>
<p>brew install --cask zulu@11</p>
<p>如果编译 Android NDK 过程中出现如下错误的</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Task :libuvccamera:ndkBuild FAILED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Android NDK: Host &#x27;awk&#x27; tool is outdated. Please define NDK_HOST_AWK to point to Gawk or Nawk !</span><br></span></code></pre></div></div>
<p>则需要在<code>~/.zshrc</code>中添加</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export NDK_HOST_AWK=/usr/bin/awk</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="xcode-编译过程问题集锦">Xcode 编译过程问题集锦<a href="#xcode-编译过程问题集锦" class="hash-link" aria-label="Direct link to Xcode 编译过程问题集锦" title="Direct link to Xcode 编译过程问题集锦" translate="no">​</a></h2>
<ul>
<li><code>Signing for &quot;React-Core-AccessibilityResources&quot; requires a development team</code></li>
</ul>
<p>Xcdoe 14 会遇到这个错误，解决方法是在 Xcode 左边的 <code>Project navigator</code> 中点击 <code>Pods</code>，然后点击此时出现在右边的 <code>Signing &amp; Capabilities</code> 并在 <code>Team</code> 下拉框中选择一个。</p>
<ul>
<li>手工下载 <code>node_modules/react-native/third-party</code></li>
</ul>
<p>如果出现这个错误</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Failed to successfully download &#x27;boost_1_63_0.tar.gz&#x27;. Debug info:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls: /Users/lizheng/Library/Caches/com.facebook.ReactNativeBuild/boost_1_63_0.tar.gz: No such file or directory</span><br></span></code></pre></div></div>
<p>则要按照 <code>node_modules/react-native/scripts/ios-install-third-party.sh</code> 中底部的几个链接手动下载，再将下载好的文件放到 <code>~/.rncache/</code> 或 <code>~/Library/Caches/com.facebook.ReactNativeBuild/</code> 中即可用 Xcode 重新编译。</p>
<p>另：如果按后文所说“使用 Cocoapods 安装 iOS 第三方库”，则不会存在本问题。</p>
<ul>
<li>&#x27;RCTAssert.h&#x27; file not found</li>
</ul>
<p>这是 react-native 最基本的一个 <code>.h</code> 文件，也会报错，对于苹果公司的产品真是无语了。这一般是因为 Xcode 或 macOS 的 bug ，重启 macOS 就可以了……如果使用外接鼠标的话，有时 macOS 突然会变得很卡，很难用鼠标进行移动、点击等操作，换个鼠标仍然如此，也是重启 macOS 就可以了，或是将鼠标接收器换个 USB 口，但如果换了，剩下的那个 USB 口有时无法正常连接 iPhone 进行调试……</p>
<ul>
<li><code>no template named function in namespace std</code></li>
</ul>
<p>Xcode 16 可能会出现这个问题，解决方法是在<code>工程文件 | Build Settings (All) | Apple Clang - Language -  C++ | C++ Language Dialect</code>中选择<code>C++11[-std=c++11]</code>。</p>
<ul>
<li>尽量在 Xcode 中编辑文件内容</li>
</ul>
<p>否则 Xcode 会不知道文件已经编辑过了。如果是在 Xcode 中编辑的话， Xcode 会自动 index 一下，然后 build 时就不会出错了。再次吐槽的是， index 和 build 的速度也太慢了。</p>
<ul>
<li>Timeout waiting for modules to be invalidated</li>
</ul>
<p>曾经在模拟器中安装调试运行时碰到过这个错误，按 <a href="https://stackoverflow.com/questions/46206867/timeout-waiting-for-modules-to-be-invalidated" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/46206867/timeout-waiting-for-modules-to-be-invalidated</a> 中的说法是需要将真机的 WiFi 连到与 macOS 同一个局域网中，不过我的情况是将模拟器换成真机后就好了，搞不懂背后真正的原因是啥。</p>
<p>注：参考 <a href="https://www.idownloadblog.com/2022/12/01/how-to-share-mac-wi-fi-internet/" target="_blank" rel="noopener noreferrer">How to share your Mac&#x27;s internet with iPhone, iPad, Android, etc</a> 一文将上网能力通过 macOS 的 USB 口分享给 iPhone ，由于是有线连接，所以 Hot reloading 的速度快到飞起。</p>
<ul>
<li>真机调试时需要在 Xcode 的菜单 <code>Preferences | Accounts</code> 那里添加 Apple ID ，并在 Xcode 的主界面中的 Project 的某个 Target 的 &#x27;Signing &amp; Capabilities&#x27; 那里选择相应的 Team 。</li>
</ul>
<p>但是，千万要记得所添加的那个 Apple ID 就是今后将要用来发布到 App Store 的账号，否则如果先用自己个人的免费账号在真机上进行调试了，那么苹果服务器就会自动将你所调试的 APP 的 PRODUCT_BUNDLE_IDENTIFIER 比如 com.domainname.appname 作为 APP ID 保存到你的个人账号名下了，那样等你后续用公司的收费账号在 <a href="https://developer.apple.com/" target="_blank" rel="noopener noreferrer">https://developer.apple.com/</a> 上申请 Identifiers 时，它就会说 &quot;An App ID with Identifier &#x27;com.domainname.appname&#x27; is not available&quot; ，而你用免费账号登录 <a href="https://developer.apple.com/" target="_blank" rel="noopener noreferrer">https://developer.apple.com/</a> 的话根本连 Identifiers 的进入按钮都看不见更别说删除该 APP ID 了，这样你只能让你的公司账号下的 PRODUCT_BUNDLE_IDENTIFIER 改名……苹果公司又一个反人类的设计。</p>
<p>第一次打包 APP 以便在真机上运行时， Xcode 会弹出对话框让你输入苹果电脑登录密码以便访问钥匙串，你确定一次后，又回弹出一次，再确定，再弹出，次数多到让你以为你输错了苹果电脑登录密码……一共会弹出 10 次左右的对话框……</p>
<ul>
<li>添加 Apple ID 时报错说“未知错误”</li>
</ul>
<p>如果局域网不太稳定（比如路由器再加一个 WiFi 放大器）就容易出现这个问题，可以通过临时连接手机热点来简单解决之。</p>
<ul>
<li>开发时也需要连接苹果公司服务器</li>
</ul>
<p>在 Xcode 中点击 Run 按钮第一次将 APP 在真机上运行时，当真机界面上出现 APP 图标时， Xcode 会弹出对话框，按照其提示到真机的 <code>设置 | 通用 | 设备管理 | 开发者 APP</code> 中进行验证，然而接着关闭 Xcode 中的对话框后， Xcode 并不会接着继续启动 APP 进行调试，如果你想在 Xcode 中看到调试信息的话，你就不得不再次点击 Run 按钮自动 build 安装共 3 分钟后才行，真是浪费生命。而更吊诡的是，如果后续某个时间你的路由器因某种原因与互联网连接断开，那么连接在路由器的 WiFi 上的真机中的 APP 又变成了需要验证的状态，也就是你没有互联网的话就连代码调试都无法做到，苹果公司的服务器时刻在看着你……</p>
<ul>
<li>用 Debug 配置进行调试</li>
</ul>
<p>由于使用 Release 配置点击 Run 按钮的话需要等待半小时，所以调试时记得将 <code>Produce | Scheme | Edit Scheme | Run | Build Configuration</code> 设置为 Debug 。其实就算使用 Debug ，运行也需要 3 分钟，哪像 react-native 开发时只需要手机摇一摇花 3 秒钟就能看到 JS 代码所做的改变。真为那些全部代码都使用 Xcode 原生编写的开发人员感到悲哀——每天不知道浪费了多少个 3 分钟。还好我只需要捏着鼻子偶尔用连语法都是反人类的 ObjectC 语言在 Xcode 中做一些原生适配，就又可以愉快地去写 JS 代码了。</p>
<p>注： <a href="https://reactnative.dev/docs/publishing-to-app-store" target="_blank" rel="noopener noreferrer">https://reactnative.dev/docs/publishing-to-app-store</a> 提到 <code>export SKIP_BUNDLING=true</code> 可以进一步减少 Debug 编译运行的时间。</p>
<ul>
<li>
<p>项目所在绝对路径中不应该有空格，否则编译会失败</p>
</li>
<li>
<p>配置 node 路径</p>
</li>
</ul>
<p>如果没有标准化安装 nodejs ，比如 <code>brew install node@10</code> 这种方式安装的，则就算已经在 <code>~/.zshrc</code> 或 <code>~/.bash_profile</code> 中 <code>export PATH=/usr/local/opt/node@10/bin:$PATH</code> 了，也还是会在真机编译时报 <code>Can&#x27;t find &#x27;node&#x27; binary to build React Native bundle</code> 这样的错误，此时需要按提示到 Xcode 的 Project 的 <code>Build Phases | Bundle React Native code and images</code> 那里将 <code>export NODE_BINARY=node</code> 改为 <code>export NODE_BINARY=$(which node)</code> 。或者还有一种方法 <code>ln -s $(which node) /usr/local/bin/node</code> 。</p>
<ul>
<li><code>EMFILE: too many open files</code></li>
</ul>
<p>如果即使<a href="https://sspai.com/post/55066" target="_blank" rel="noopener noreferrer">macOS 开启或关闭 SIP</a>关闭 SIP 然后<code>launchctl limit maxfiles 16384 16384 &amp;&amp; ulimit -n 16384</code>了也没用，那是因为对于 M2 的苹果电脑，需要做的是参考 <a href="https://github.com/facebook/watchman/issues/923#issuecomment-2550990976" target="_blank" rel="noopener noreferrer">https://github.com/facebook/watchman/issues/923#issuecomment-2550990976</a> 中那样在<code>TARGETS &gt; (your app) &gt; Build Phases &gt; Bundle React Native code and images</code>中将<code>/opt/homebrew/bin</code>添加到<code>$PATH</code>中。另外，还需在编译前手动执行一次<code>watchman watch-del-all</code>。</p>
<ul>
<li><code>ld: 5 uplicate symbols</code></li>
</ul>
<p>将 XCode 升级到 15 之后，比如编译使用着<code>telink sdk v3.3.3.5</code>的<code>react-native-btsig-telink@5.0.3</code>时，在链接阶段报了该错误，以其中一个为例</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">duplicate symbol &#x27;_OBJC_IVAR_$_SigECCEncryptHelper._crypto&#x27;</span><br></span></code></pre></div></div>
<p>解决方法是在 Xcode 的 Project 的<code>Build Settings(All) | Linking | Other Linker Flags</code>内添加 <code>-ld_classic</code>。</p>
<ul>
<li>release error with <a href="https://github.com/Andarist/data-uri.macro" target="_blank" rel="noopener noreferrer">data-uri.macro</a></li>
</ul>
<p>如果 APP 中使用了 <code>data-uri.macro</code> ，则 release 打包时会出现比如 <code>Error: /Users/YOU/proj/YOUR_APP/ios/app/images/gif/index.js: data-uri.macro: ENOENT: no such file or directory, open &#x27;/Users/YOU/proj/YOUR_APP/ios/app/images/gif/spot.gif&#x27;</code> ，此时需要到 Xcode 的 Project 的 <code>Build Phases | Bundle React Native code and images</code> 那里将</p>
<p>../node_modules/react-native/scripts/react-native-xcode.sh</p>
<p>改为</p>
<p>cd ..
./node_modules/react-native/scripts/react-native-xcode.sh</p>
<ul>
<li>为 Xcode 添加 iOS-DeviceSupport</li>
</ul>
<p>如果真机调试运行时出现比如 <code>This iPhone 7 (Model 1660, 1778, 1779, 1780) is running iOS 13.2.3 (17B111), which may not be supported by this version of Xcode. An updated version of Xcode may be found on the App Store or at developer.apple.com.</code> 这样的错误提示，它的意思是当前版本的 Xcode 不支持真机上的 iOS 操作系统版本。调试一个手机 APP 还必须要 IDE 支持手机操作系统的版本，这样的反人类设计恐怕也只有苹果公司才做得出来。可以如提示中所说升级 Xcode 自身，但 Xcode 安装包要 7 个多 GB ，而且偶尔某个版本的 Xcode 会出现一些奇奇怪怪的 BUG ，所以最简洁的方式其实是为当前版本的 Xcode 的安装目录某个地方多添加一个比如 13.2 目录即可。</p>
<p>从 <a href="https://github.com/iGhibli/iOS-DeviceSupport/tree/master/DeviceSupport" target="_blank" rel="noopener noreferrer">https://github.com/iGhibli/iOS-DeviceSupport/tree/master/DeviceSupport</a> 下载比如 <code>13.2(FromXcode11.2.1(11B500)).zip</code> ，解压出 <code>13.2</code> 目录， <code>sudo mv 13.2 /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/</code> ，最后重启 Xcode 并重连手机即可。</p>
<ul>
<li><code>dyld: Library not loaded: /usr/local/opt/icu4c/lib/libicui18n.66.dylib</code></li>
</ul>
<p>如果在 Xcode 持续开启的状态下，比如为了满足 App Store 上预览视频的分辨率要求而在终端里 <code>brew install ffmpeg</code> 用于视频转码，然后一转眼 Xcode 运行 <code>Product | Archive</code> 打包到 node 步骤时即可能报上述错误，其原因是 node 和 ffmpeg 都依赖 icu4u ，而一般情况下 node 是比较早之前安装的，那时候自动安装的 icu4u 版本如果比现在 ffmpeg 触发安装的 icu4u 版本旧的话，就会出现本问题。解决的方法是重新启动 Xcode 。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="app-store-反人类集锦">App Store 反人类集锦<a href="#app-store-反人类集锦" class="hash-link" aria-label="Direct link to App Store 反人类集锦" title="Direct link to App Store 反人类集锦" translate="no">​</a></h2>
<ul>
<li>难以理解的开发证书、生产证书、描述文件</li>
</ul>
<p>不像 Android 的 apk 只需要命令行生成一个 key 用来签名就可以发布到 Google PLAY 了，你需要浪费生命中的几个小时甚至几天来理解 <a href="https://blog.csdn.net/Bolted_snail/article/details/80764572" target="_blank" rel="noopener noreferrer">iOS开发证书、bundle ID、App ID、描述文件、p12文件，企业证书打包发布，及过期处理</a> 、 <a href="https://www.cnblogs.com/ioshe/p/5481456.html" target="_blank" rel="noopener noreferrer">iOS开发者证书申请及应用上线发布详解</a> 、 <a href="https://www.jianshu.com/p/a81c01323a89" target="_blank" rel="noopener noreferrer">ios开发证书的坑</a> 这些文章并进行相关操作。</p>
<p>其中一个需要理解的是， Xcode 第一次连接真机进行调试时，它会询问你是否将真机加入设备列表以便放入描述文件，在你点击确定后，它其实偷偷摸摸将你的真机的 UUID 放到了 <a href="https://developer.apple.com/account/resources/devices/list" target="_blank" rel="noopener noreferrer">https://developer.apple.com/account/resources/devices/list</a> ，并且自动为你生成了调试用的描述文件，里面内含真机的 UUID 信息，也就是说使用这个描述文件打包的 APP 只能在这个真机运行，而 <a href="https://developer.apple.com/account/resources/profiles/list" target="_blank" rel="noopener noreferrer">https://developer.apple.com/account/resources/profiles/list</a> 中的是发布用的描述文件，里面不含真机的 UUID 信息，也就是说使用这个描述文件打包的 APP 可以在任何设备上运行。所以我们不用关心网页上的设备列表，只需要关心在网页上创建描述文件并下载以便发布即可。</p>
<ul>
<li>没有提示自动审核</li>
</ul>
<p>如果在 Xcode 中用 <code>Window | Organizer | Distribute App</code> 成功上传到了 App Store 中，但却无法在 <a href="https://appstoreconnect.apple.com/" target="_blank" rel="noopener noreferrer">https://appstoreconnect.apple.com/</a> 的任何地方找到该构建版本的信息，这一般是因为苹果公司服务器自动审核你上传的 ipa 后发现了问题，所以你需要到相关邮箱中等待苹果公司服务器自动发来的电子邮件。问题是没有任何提示告诉你需要到邮箱中等待……</p>
<ul>
<li>不会自动选择构建版本</li>
</ul>
<p>即便你解决了自动审核提出的问题，也重新上传到 App Store 中了，而且也能在 <a href="https://appstoreconnect.apple.com/" target="_blank" rel="noopener noreferrer">https://appstoreconnect.apple.com/</a> 的 TestFlight 和活动中看到该构建版本的信息了，但你还是需要去点击“构建版本”文字旁边的 + 号进行选择才能准备“提交以供审核”。</p>
<ul>
<li>出口合规证明信息</li>
</ul>
<p>需要到 <a href="https://appstoreconnect.apple.com/" target="_blank" rel="noopener noreferrer">https://appstoreconnect.apple.com/</a> 的 TestFlight 中进行“出口合规证明信息”，说是</p>
<p>您的 App 是否使用加密？即使您的 App 只使用了 Apple 操作系统中的标准加密，也请选择“是”。
如果您正在使用 ATS 或调用 HTTPS，则您必须向美国政府提交年终自行分类报告。</p>
<p>不过正像 <a href="https://stackoverflow.com/questions/45008590/itunesconnect-requires-me-to-submit-year-end-self-qualification-report" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/45008590/itunesconnect-requires-me-to-submit-year-end-self-qualification-report</a> 里面有人提到的，如果美国政府相关机构不对我们的申请进行回复，难道就不上架 App Store 了？实际上从 <a href="http://zhanglinhai.com/archives/689" target="_blank" rel="noopener noreferrer">App Store 上架关键步骤：出口合规信息、内容版权、广告标识符的选择</a> 一文来看，这个现在可能已经没人真正去管了。所以我们可以按照 <a href="https://www.jianshu.com/p/edc246feed9c" target="_blank" rel="noopener noreferrer">iOS app TestFlight 缺少出口合规证明</a> 所说在 Info.plist 中设置 <code>&lt;key&gt;ITSAppUsesNonExemptEncryption&lt;/key&gt;&lt;false/&gt;</code> 键值对，这样我们下次上传构建版本后就不会看到这个“出口合规证明信息”了。</p>
<ul>
<li>App 预览和截屏</li>
</ul>
<p>要上传或查看预览视频，只能使用 Safari 浏览器，用 Chrome 都不行……</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="app-store-更新-app-流程">App Store 更新 APP 流程<a href="#app-store-更新-app-流程" class="hash-link" aria-label="Direct link to App Store 更新 APP 流程" title="Direct link to App Store 更新 APP 流程" translate="no">​</a></h2>
<p>前文提到了首次上架 APP 时的一些繁琐操作。这里再简单罗列下更经常用到的更新 APP 的流程，以尽量从苹果公司手里挽回点宝贵的生命……</p>
<p>在 <a href="https://appstoreconnect.apple.com/apps" target="_blank" rel="noopener noreferrer">https://appstoreconnect.apple.com/apps</a> 中的 “App Store” 那里新增一个版本号比如 1.2 ，并在 project.pbxproj 中的 MARKETING_VERSION （也就是 Xcode 的主界面中的 Project 的某个 Target 的 General 那里的 Version ）处也写上相同的版本号 1.2 ，以及在 CURRENT_PROJECT_VERSION （也就是 Xcode 的主界面中的 Project 的某个 Target 的 General 那里的 Build ）中写上比如 1.2.0 （如果审核被拒了，只要简单修改成比如 1.2.1 就可以再次上传）</p>
<p>cd ios
pod install</p>
<p>在 Xcode 的主界面中的 Project 的某个 Target 的 &#x27;Signing &amp; Capabilities&#x27; 那里选择相应的 Team 。</p>
<p>在 Xcode 运行 <code>Product | Archive</code> 打包。</p>
<p>在 Xcode 中用 <code>Window | Organizer | Distribute App</code> 上传到 App Store 中。</p>
<p>上传后可以在 <a href="https://appstoreconnect.apple.com/apps" target="_blank" rel="noopener noreferrer">https://appstoreconnect.apple.com/apps</a> 中的 “活动” 那里看到正在被自动审核（如果没看到，就要去查你的邮箱是否有苹果公司发来的邮件了），然后大概几分钟后自动审核成功，就能在 “App Store” 那里的 “构建版本” 旁边看到出现一个 + 号了，点击选择后，并且填写 “此版本的新增内容” ，就可以点击“存储”和“提交以供审核”按钮了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用-cocoapods-安装-ios-第三方库">使用 Cocoapods 安装 iOS 第三方库<a href="#使用-cocoapods-安装-ios-第三方库" class="hash-link" aria-label="Direct link to 使用 Cocoapods 安装 iOS 第三方库" title="Direct link to 使用 Cocoapods 安装 iOS 第三方库" translate="no">​</a></h2>
<p>首先是安装 cocoapods 自身</p>
<p>sudo gem install cocoapods</p>
<p>在 <code>ios/</code> 目录中运行 <code>pod init</code> 以生成 Podfile 文件，然后可以按需修改，推荐按照下面会提到的 <a href="https://github.com/unimodules/react-native-unimodules" target="_blank" rel="noopener noreferrer">react-native-unimodules</a> 的 README.md 说的那样修改 <code>ios/Podfile</code> 。除了 react-native-unimodules 外，在 react-native@0.60 及更高版本一般是不需要修改 <code>ios/Podfile</code> 的。</p>
<p>最后就可以这样简单地安装 iOS 第三方库了（而不是像前文那样还要手工下载 <code>node_modules/react-native/third-party</code> ）:</p>
<p>pod install</p>
<p>安装完后它会提示退出 Xcode 进程，并且下次 Xcode 启动后需要 <code>Open another project...</code> 打开 <code>ios/</code> 目录中的 <code>.xcworkspace</code> 而非 <code>.xcodeproj</code> 。</p>
<p>使用 <code>pod install</code> 方式的话，就不需要再运行以前安装 react-native 第三方组件经常所需的 <code>react-native link</code> 命令，如果曾经运行过，则需要 <code>react-native unlink</code> 。</p>
<p>如果 <code>pod install</code> 速度很慢或者干脆无法完成，可以参考 <a href="https://mirrors.tuna.tsinghua.edu.cn/help/CocoaPods/" target="_blank" rel="noopener noreferrer">清华大学开源软件镜像站 CocoaPods 镜像使用帮助</a></p>
<p>注：许多网页介绍的清华镜像下载速度很慢甚至无法下载完成，所以推荐将下面语句中的 <code>https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git</code> 替换为 <code>https://gitee.com/mirrors/CocoaPods-Specs.git</code> 。如果你能下载大型的 github 仓库而不中途被断掉的话（比如通过 <code>git config --global http.proxy 你的代理服务器</code> 的方式），则推荐替换为更加实时更新的 <code>https://github.com/CocoaPods/Specs.git</code> 。</p>
<p>cd ~/.cocoapods/repos
pod repo remove master
git clone --depth 1 <a href="https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git" target="_blank" rel="noopener noreferrer">https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git</a> master</p>
<p>后续如果 <code>pod install</code> 时出现 <code>CocoaPods could not find compatible versions for pod</code> 的错误而想要更新，只需</p>
<p>cd ~/.cocoapods/repos/master
git pull</p>
<p>即可。最后进入自己的工程，在自己工程的 Podfile 第一行加上：</p>
<p>source &#x27;<a href="https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git" target="_blank" rel="noopener noreferrer">https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git</a>&#x27;</p>
<p>或是让 Podfile 中保持 <code>https://github.com/CocoaPods/Specs.git</code> 并且将 <code>~/.cocoapods/repos/master/.git/config</code> 中的 <code>https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git</code> 替换为 <code>https://github.com/CocoaPods/Specs.git</code> ，则也是可以的。</p>
<p>然后就可以正常 <code>pod install</code> 了（第一次可能需要删除已经存在的 Podfile.lock 文件）。</p>
<p>另外，有时候比如 <code>git reset</code> 到某个提交点后做 <code>pod install</code> 时出现</p>
<p>NoMethodError - undefined method `each&#x27; for nil<!-- -->:NilClass</p>
<p>的错误，这一般也是需要删除 Podfile.lock 文件。</p>
<p>如果 <code>pod install</code> 时卡死在某个 <code>Installing</code> 上，或者最终它报出来 <code>LibreSSL SSL_connect: Operation timed out in connectiong to github.com:443</code>，则可以参照<a href="https://blog.csdn.net/u011374880/article/details/106327526" target="_blank" rel="noopener noreferrer">pod install/update 卡住</a>一文里的解决方法，或是在 <code>~/.gitconfig</code> 中添加</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    [http &quot;https://github.com/&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy = http://你的科学上网代理IP:端口</span><br></span></code></pre></div></div>
<p>如果 <code>pod install</code> 时出现比如 <code>[!] </code>OpenSSL-Universal<code>requires CocoaPods version</code>&gt;= 1.9<code>, which is not satisfied by your current version, </code>1.8.4<code>.</code> 这样的错误，则先需要</p>
<p>sudo gem install cocoapods -v 1.9.0</p>
<p>但如果此时出现比如</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Fetching: ffi-1.15.0.gem (100%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Building native extensions.  This could take a while...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR:  Error installing cocoapods:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ERROR: Failed to build gem native extension.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    current directory: /Library/Ruby/Gems/2.3.0/gems/ffi-1.15.0/ext/ffi_c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby -r ./siteconf20210308-55404-19a0g74.rb extconf.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkmf.rb can&#x27;t find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/include/ruby.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extconf failed, exit code 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gem files will remain installed in /Library/Ruby/Gems/2.3.0/gems/ffi-1.15.0 for inspection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Results logged to /Library/Ruby/Gems/2.3.0/extensions/universal-darwin-18/2.3.0/ffi-1.15.0/gem_make.out</span><br></span></code></pre></div></div>
<p>这样的错误，则先需要比如</p>
<p>open /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg</p>
<p>但如果此时出现找不到这个 <code>.pkg</code> 文件的错误，则先需要</p>
<p>xcode-select --install</p>
<p>但如果此时出现</p>
<p>xcode-select: error: command line tools are already installed, use &quot;Software Update&quot; to install updates</p>
<p>这样的错误，则先需要</p>
<p>rm -rf /Library/Developer/CommandLineTools</p>
<p>如果 <code>pod install</code> 时出现比如 <code>Could not find &#x27;minitest&#x27;</code> 这样的错误，则需要</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">unset GEM_HOME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unset GEM_PATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unset MY_RUBY_HOME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unset RUBY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unset IRBRC</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="一些-cocoapods-使用技巧">一些 Cocoapods 使用技巧<a href="#一些-cocoapods-使用技巧" class="hash-link" aria-label="Direct link to 一些 Cocoapods 使用技巧" title="Direct link to 一些 Cocoapods 使用技巧" translate="no">​</a></h3>
<p><code>pod install</code> 背后的原理其实就是生成了一个 <code>ios/Pods/</code> 目录，并在里面自动放入或删除各个第三方库的 <code>.h</code> 头文件及编译配置文件。 <code>.h</code> 头文件所在的目录名就是相应第三方库的 <code>.podspec</code> 文件中写明的 <code>name</code> 字段，这样你自己的源代码或其它第三方库就能简单地以 <code>&lt;SomeName/some.h&gt;</code> 来调用该库的功能了。</p>
<p><code>.podspec</code> 文件中的 <code>source</code> 字段虽然是必须的，但只要你自己的源代码并不打算发布到 cocoapods 则 <code>source</code> 字段里面的内容是可以瞎写的，因为就算你写了个不存在的 <code>.git</code> 网络链接， <code>pod install</code> 仍然会从当前硬盘中该 <code>.podspec</code> 文件所在路径中软链接 <code>source_files</code> 字段指定的 <code>.h</code> 头文件到 <code>ios/Pods/</code> 相应目录中。</p>
<p><code>.podspec</code> 文件中的 <code>source_files</code> 字段中的路径必须是当前 <code>.podspec</code> 文件所在路径及其子目录，如果用 <code>../</code> 来指明上层目录的话，虽然 <code>pod install</code> 时不会报错，但实际上并没有任何 <code>.h</code> 文件被软链接过去导致后续编译失败。</p>
<p>如果你有自己的带有 <code>Headers/</code> 目录的 pod 库比如 <code>SomeFrame.framework</code> ，也有使用到该 framework 的自己的另一个 pod 源代码比如 <code>SomeSource</code> ，而且这两者都不打算发布到 cocoapods ，则除了在 <code>Podfile</code> 中将这两个 pod 都写进去之外， 还需要在 <code>SomeSource</code> 的 <code>.podspec</code> 文件中写明 <code>s.dependency &#x27;SomeFrame&#x27;</code> 语句，否则虽然 <code>pod install</code> 时不会报错，但后续在编译到 <code>SomeSource</code> 时会报错说找不到 <code>&lt;SomeFrame/some.h&gt;</code> 文件。这里也可以看到苹果公司编译系统一个反人类的设计（另一个反人类的是 objectC 中的方括号 [] 函数调用语法）：你无法成功 <code>#import &lt;SomeFrame.framework/Headers/some.h&gt;</code> ，而只能在如上所说 <code>s.dependency &#x27;SomeFrame&#x27;</code> 之后才能成功 <code>#import &lt;SomeFrame/some.h&gt;</code> ，虽然实际上硬盘里的 <code>some.h</code> 并不存在于任何叫做 <code>SomeFrame/</code> 的目录中。</p>
<p><code>pod install</code> 运行结束后可能会有一些警告提示 <code>target overrides</code> ，这可以参考 <a href="https://www.jianshu.com/p/dfb2a5834cd0" target="_blank" rel="noopener noreferrer">解决使用 CocoaPods 执行 pod install 时出现 - Use the <code>$（inherited）</code> flag ... 警告</a> 。</p>
<p>可以参阅 <a href="https://www.jianshu.com/p/b8b889610b7e" target="_blank" rel="noopener noreferrer">Podfile文件用法详解</a> 等文章。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="redux">Redux<a href="#redux" class="hash-link" aria-label="Direct link to Redux" title="Direct link to Redux" translate="no">​</a></h2>
<p><a href="https://segmentfault.com/a/1190000003099895" target="_blank" rel="noopener noreferrer">还在纠结 Flux 或 Relay，或许 Redux 更适合你</a></p>
<p><a href="http://cn.redux.js.org/" target="_blank" rel="noopener noreferrer">Redux 中文文档 </a></p>
<p>npm install --save redux react-redux
npm install --save-dev redux-devtools</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="isolating-redux-sub-apps">Isolating Redux Sub-Apps<a href="#isolating-redux-sub-apps" class="hash-link" aria-label="Direct link to Isolating Redux Sub-Apps" title="Direct link to Isolating Redux Sub-Apps" translate="no">​</a></h3>
<p>Want render a react-native APP as a sub-app (library) in other APP? I implement this requirement in <a href="https://github.com/flyskywhy/PixelShapeRN/commit/9728e45ffe4a5046d7cd8076b2b103c5eef079c5" target="_blank" rel="noopener noreferrer">let other react-native APP can embed PixelShapeRN as sub-app</a>, which ref to <a href="https://redux.js.org/usage/isolating-redux-sub-apps" target="_blank" rel="noopener noreferrer">Isolating Redux Sub-Apps</a> and <a href="https://gist.github.com/gaearon/eeee2f619620ab7b55673a4ee2bf8400" target="_blank" rel="noopener noreferrer">Breaking out of Redux paradigm to isolate apps</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="react-native-unimodules">react-native-unimodules<a href="#react-native-unimodules" class="hash-link" aria-label="Direct link to react-native-unimodules" title="Direct link to react-native-unimodules" translate="no">​</a></h2>
<p>react-native 兴起之初，各种第三方组件百家争鸣，但也良莠不齐。最近看来 react-native-unimodules 渐有一统之势，它支持许多开发 APP 时用得到的方方面面的 <a href="https://docs.expo.io/versions/latest/bare/unimodules-full-list/" target="_blank" rel="noopener noreferrer">Packages</a> ，而且其中所谓 bare workflow 也就是不需要和 Expo 绑定的独立 Packages 已经足够多了。</p>
<p>如果是在 iOS 中使用 react-native-unimodules ，则必须要使用上面提到的 <code>pod install</code> 才能正常运行。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-react-native-unimodules-without-install-expo">install react-native-unimodules without install expo<a href="#install-react-native-unimodules-without-install-expo" class="hash-link" aria-label="Direct link to install react-native-unimodules without install expo" title="Direct link to install react-native-unimodules without install expo" translate="no">​</a></h3>
<p>The worked well version is</p>
<p>&quot;react-native-unimodules&quot;: &quot;0.10.1&quot;,</p>
<p>and related</p>
<p>&quot;expo-application&quot;: &quot;2.4.1&quot;,
&quot;expo-document-picker&quot;: &quot;8.3.0&quot;,
&quot;expo-gl&quot;: &quot;8.4.0&quot;,
&quot;expo-keep-awake&quot;: &quot;8.0.0&quot;,
&quot;expo-location&quot;: &quot;10.0.0&quot;,</p>
<p>The installation of <code>react-native-unimodules</code> can ref to this commit <a href="https://github.com/flyskywhy/snakeRN/commit/90983816de3ad2a4da47ffa0f6d1659c2688be3e" target="_blank" rel="noopener noreferrer">expo -&gt; react-native: add react-native-unimodules</a>, and if RN &gt;= 0.65 , to compile react-native-unimodules, need downgrade to gradle-6.7.1-all.zip in <code>YOUR_APP/android/gradle/wrapper/gradle-wrapper.properties</code> , and because <code>invalidate</code> replaces <code>onCatalystInstanceDestroy</code> in RN &gt;= 0.65, ref to <a href="https://github.com/facebook/react-native/commit/18c8417290823e67e211bde241ae9dde27b72f17" target="_blank" rel="noopener noreferrer">https://github.com/facebook/react-native/commit/18c8417290823e67e211bde241ae9dde27b72f17</a>, you need</p>
<p>sed -i -e &quot;s/^}$/public void invalidate() <!-- -->}/&quot; node_modules/@unimodules/react-native-adapter/android/src/main/java/org/unimodules/adapters/react/services/CookieManagerModule.java</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一些-bug-的解决方法">一些 BUG 的解决方法<a href="#一些-bug-的解决方法" class="hash-link" aria-label="Direct link to 一些 BUG 的解决方法" title="Direct link to 一些 BUG 的解决方法" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fixed-typeerror-network-request-failed-when-upload-file-to-http-not-https-with-android-debug-builds"><a href="https://github.com/facebook/react-native/issues/33217#issuecomment-1159844475" target="_blank" rel="noopener noreferrer">fixed <code>TypeError: Network request failed</code> when upload file to http not https with Android debug builds</a><a href="#fixed-typeerror-network-request-failed-when-upload-file-to-http-not-https-with-android-debug-builds" class="hash-link" aria-label="Direct link to fixed-typeerror-network-request-failed-when-upload-file-to-http-not-https-with-android-debug-builds" title="Direct link to fixed-typeerror-network-request-failed-when-upload-file-to-http-not-https-with-android-debug-builds" translate="no">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fixed-xmobile-calling-netinterfaceaddrs-fails-on-android-sdk-30-if-use-go-on-android--11">Fixed <a href="https://github.com/golang/go/issues/40569#issuecomment-1190950966" target="_blank" rel="noopener noreferrer">x/mobile: Calling net.InterfaceAddrs() fails on Android SDK 30</a> if use GO on Android &gt;= 11<a href="#fixed-xmobile-calling-netinterfaceaddrs-fails-on-android-sdk-30-if-use-go-on-android--11" class="hash-link" aria-label="Direct link to fixed-xmobile-calling-netinterfaceaddrs-fails-on-android-sdk-30-if-use-go-on-android--11" title="Direct link to fixed-xmobile-calling-netinterfaceaddrs-fails-on-android-sdk-30-if-use-go-on-android--11" translate="no">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rootdirnode_modulesreact-nativeandroid-as-react-native-android-import-from-node_modules-directory-does-not-working"><code>$rootDir/../node_modules/react-native/android</code> as <a href="https://stackoverflow.com/questions/50354939/react-native-android-import-from-node-modules-directory-does-not-working" target="_blank" rel="noopener noreferrer">React-Native Android import from node_modules directory does not working</a><a href="#rootdirnode_modulesreact-nativeandroid-as-react-native-android-import-from-node_modules-directory-does-not-working" class="hash-link" aria-label="Direct link to rootdirnode_modulesreact-nativeandroid-as-react-native-android-import-from-node_modules-directory-does-not-working" title="Direct link to rootdirnode_modulesreact-nativeandroid-as-react-native-android-import-from-node_modules-directory-does-not-working" translate="no">​</a></h3>
<p>The 2022-11 issue <a href="https://github.com/facebook/react-native/issues/35210" target="_blank" rel="noopener noreferrer">No matching variant of com.facebook.react:react-native:0.71.0-rc.0 was found.</a> will cause one of Android build/run failures below:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">AAPT: error: resource android:attr/lStar not found</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java.lang.IncompatibleClassChangeError: Found class com.facebook.react.uimanager.events.EventDispatcher, but interface was expected</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Manifest merger failed : uses-sdk:minSdkVersion 16 cannot be smaller than version 21 declared in library [com.facebook.react:react-native:0.71.0-rc.0] ~/.gradle/caches/transforms-2/files-2.1/b7e5811cc2418a7984972c8ebe02d2c4/jetified-react-native-0.71.0-rc.0-debug/AndroidManifest.xml as the library might be using APIs not available in 16</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Could not download react-native-0.71.0-rc.0-debug.aar (com.facebook.react:react-native:0.71.0-rc.0): No cached version available for offline mode</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/@minar-kotonoha/react-native-threads/android/src/main/java/com/reactlibrary/ReactContextBuilder.java:15: 错误: 找不到符号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import com.facebook.react.bridge.NativeModuleCallExceptionHandler;</span><br></span></code></pre></div></div>
<p>Then fix below in <code>android/app/build.gradle</code> does not working anymore:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">implementation (&quot;com.facebook.react:react-native:0.63.2&quot;) { force = true }</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">implementation &quot;com.facebook.react:react-native:0.63.2!!&quot;</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">android {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    configurations.all {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        resolutionStrategy {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // failOnVersionConflict()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // force &#x27;com.facebook.react:react-native:0.63.2&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            substitude module(&#x27;com.facebook.react:react-native:+&#x27;) with module(&#x27;com.facebook.react:react-native:0.63.2&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">android {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    configurations.all {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (details.requested.group == &#x27;com.facebook.react&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &amp;&amp; details.requested.name == &#x27;react-native&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                details.useVersion &quot;0.63.2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // details.useTarget group:&#x27;com.facebook.react&#x27;, name:&#x27;react-native&#x27;, version:&quot;0.63.2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // it.substitute it.module(&quot;com.facebook.react:react-native:+&quot;) with module(&quot;com.facebook.react:react-native:0.63.2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Finally fix below in <code>android/build.gradle</code>  can work ref to <a href="https://github.com/facebook/react-native/issues/35204#issuecomment-1304740228" target="_blank" rel="noopener noreferrer">https://github.com/facebook/react-native/issues/35204#issuecomment-1304740228</a> :</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    allprojects {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        repositories {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exclusiveContent {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                filter {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    includeGroup &quot;com.facebook.react&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                forRepository {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    maven {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        url &quot;$rootDir/../node_modules/react-native/android&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // actually now can remove below lines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // All of React Native (JS, Obj-C sources, Android binaries) is installed from npm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            url(&quot;$rootDir/../node_modules/react-native/android&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recompile-with--xlint-for-details">Recompile with -Xlint<!-- -->:deprecation<!-- --> for details<a href="#recompile-with--xlint-for-details" class="hash-link" aria-label="Direct link to recompile-with--xlint-for-details" title="Direct link to recompile-with--xlint-for-details" translate="no">​</a></h3>
<p>If got an error like below:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Note: ... SOME.java uses or overrides a deprecated API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Note: Recompile with -Xlint:deprecation for details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FAILURE: Build failed with an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Where:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Script &#x27;YOUR_APP/node_modules/react-native/react.gradle&#x27; line: 319</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* What went wrong:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Execution failed for task &#x27;:app:packageDebug&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; react_80jkne8u4hv8b3lwi0xrttidv$_run_closure4$_closure6$_closure10$_closure18</span><br></span></code></pre></div></div>
<p>Then you need remove <code>~/.gradle/caches/</code>, if some file in it can&#x27;t be removed for &quot;file is in use&quot; on Windows, you should restart Windows and remove it again. Ref to <a href="https://github.com/facebook/react-native/issues/28665#issuecomment-826251902" target="_blank" rel="noopener noreferrer">https://github.com/facebook/react-native/issues/28665#issuecomment-826251902</a> .</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compile-some-3rd-lib-got-read-timed-out-could-not-get-httpsmavengooglecomcomfacebookreactreact-nativemaven-metadataxml">Compile some 3rd lib got <code>Read timed out</code> <code>Could not GET &#x27;https://maven.google.com/com/facebook/react/react-native/maven-metadata.xml&#x27;</code><a href="#compile-some-3rd-lib-got-read-timed-out-could-not-get-httpsmavengooglecomcomfacebookreactreact-nativemaven-metadataxml" class="hash-link" aria-label="Direct link to compile-some-3rd-lib-got-read-timed-out-could-not-get-httpsmavengooglecomcomfacebookreactreact-nativemaven-metadataxml" title="Direct link to compile-some-3rd-lib-got-read-timed-out-could-not-get-httpsmavengooglecomcomfacebookreactreact-nativemaven-metadataxml" translate="no">​</a></h3>
<p>Ref to <a href="https://github.com/flyskywhy/ReactWebNative8Koa/commit/96fad3d9524e64fa309d0e72a4d9ad4808a1470f" target="_blank" rel="noopener noreferrer">RN 0.63.2 -&gt; 0.70.5: fix Read timed out when compiling on Android</a> , need add below into <code>settings.gradle</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ref to https://docs.gradle.org/7.5.1/userguide/declaring_repositories.html#sub:centralized-repository-declaration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dependencyResolutionManagement {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // to fix `Read timed out` e.g.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    &gt; Could not resolve com.facebook.react:react-native:0.70.+.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //       &gt; Failed to list versions for com.facebook.react:react-native.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //          &gt; Unable to load Maven meta-data from https://maven.google.com/com/facebook/react/react-native/maven-metadata.xml.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //             &gt; Could not GET &#x27;https://maven.google.com/com/facebook/react/react-native/maven-metadata.xml&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //                &gt; Read timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    &gt; Could not download bcprov-jdk15on-1.48.jar (org.bouncycastle:bcprov-jdk15on:1.48)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //       &gt; Could not get resource &#x27;https://repo.maven.apache.org/maven2/org/bouncycastle/bcprov-jdk15on/1.48/bcprov-jdk15on-1.48.jar&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //          &gt; Read timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //    &gt; Could not download guava-17.0.jar (com.google.guava:guava:17.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //       &gt; Could not get resource &#x27;https://repo.maven.apache.org/maven2/com/google/guava/guava/17.0/guava-17.0.jar&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //          &gt; Read timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repositoriesMode.set(RepositoriesMode.PREFER_SETTINGS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repositories {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://mirrors.cloud.tencent.com/nexus/repository/maven-public/&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://mirrors.163.com/maven/repository/maven-public/&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://maven.aliyun.com/repository/google&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://maven.aliyun.com/repository/jcenter&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://maven.aliyun.com/repository/central&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // maven { url &#x27;https://maven.aliyun.com/repository/gradle-plugin&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://maven.aliyun.com/nexus/content/groups/public&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // All of React Native (JS, Obj-C sources, Android binaries) is installed from npm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            url(&quot;$rootDir/../node_modules/react-native/android&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Android JSC is installed from npm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            url(&quot;$rootDir/../node_modules/jsc-android/dist&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mavenCentral {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // We don&#x27;t want to fetch react-native from Maven Central as there are</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // older versions over there.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            content {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                excludeGroup &quot;com.facebook.react&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        google()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maven { url &#x27;https://www.jitpack.io&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>and also remove useless <code>allprojects</code> in <code>build.gradle</code>.</p>
<p>Now after <code>./android/gradlew clean -p ./android/</code>, you can continue your build.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aapt-error-resource-androidattrcolorerror-not-found"><code>AAPT: error: resource android:attr/colorError not found</code><a href="#aapt-error-resource-androidattrcolorerror-not-found" class="hash-link" aria-label="Direct link to aapt-error-resource-androidattrcolorerror-not-found" title="Direct link to aapt-error-resource-androidattrcolorerror-not-found" translate="no">​</a></h3>
<p>If got error like</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; A failure occurred while executing com.android.build.gradle.tasks.VerifyLibraryResourcesTask$Action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &gt; Android resource linking failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ERROR: node_modules/@flyskywhy/react-native-locale-detector/android/build/intermediates/merged_res/release/values-v26/values-v26.xml:7: AAPT: error: resource android:attr/colorError not found.</span><br></span></code></pre></div></div>
<p>you may need add below into <code>YOUR_APP/android/build.gradle</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">subprojects {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    afterEvaluate {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        project -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (project.hasProperty(&quot;android&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                android {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    compileSdkVersion = rootProject.compileSdkVersion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    buildToolsVersion = rootProject.buildToolsVersion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="could-not-resolve-orgwebkitandroid-jsc"><code>Could not resolve org.webkit:android-jsc:+</code><a href="#could-not-resolve-orgwebkitandroid-jsc" class="hash-link" aria-label="Direct link to could-not-resolve-orgwebkitandroid-jsc" title="Direct link to could-not-resolve-orgwebkitandroid-jsc" translate="no">​</a></h3>
<p>Downgrade gradle-6.7-all.zip (comes from RN 0.64.3) to gradle-6.2-all.zip (comes from RN 0.63.2) in <code>android/gradle/wrapper/gradle-wrapper.properties</code> to fix it, ref to <a href="https://stackoverflow.com/a/76521192/6318705" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/a/76521192/6318705</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="专治各种网络不服"><a href="https://incoder.org/2020/02/27/fuck-gfw/" target="_blank" rel="noopener noreferrer">专治各种网络不服</a><a href="#专治各种网络不服" class="hash-link" aria-label="Direct link to 专治各种网络不服" title="Direct link to 专治各种网络不服" translate="no">​</a></h3></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/ReactNative项目中把任意二进制文件打包进APP的方法"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ReactNative项目中把任意二进制文件打包进APP的方法</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/g/docs/i主观的体验方式/t快乐的体验/电信/Tool/编程语言/JavaScript/emsdk使用详解"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">emsdk使用详解</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#安装-nodejs-及其自带的包下载工具-npm" class="table-of-contents__link toc-highlight">安装 node.js 及其自带的包下载工具 npm</a><ul><li><a href="#配置-npm-镜像" class="table-of-contents__link toc-highlight">配置 npm 镜像</a></li></ul></li><li><a href="#安装-watchman" class="table-of-contents__link toc-highlight">安装 watchman</a><ul><li><a href="#安装依赖" class="table-of-contents__link toc-highlight">安装依赖</a></li><li><a href="#安装-watchman-如果出错-查看安装依赖的详细文档" class="table-of-contents__link toc-highlight">安装 watchman, 如果出错, 查看安装依赖的详细文档</a></li></ul></li><li><a href="#安装-flow" class="table-of-contents__link toc-highlight">安装 flow</a></li><li><a href="#项目名称限制" class="table-of-contents__link toc-highlight">项目名称限制</a></li><li><a href="#安装-react-native-cli" class="table-of-contents__link toc-highlight">安装 react-native-cli</a></li><li><a href="#创建-react-native-项目" class="table-of-contents__link toc-highlight">创建 react-native 项目</a></li><li><a href="#配置-android-开发环境" class="table-of-contents__link toc-highlight">配置 Android 开发环境</a></li><li><a href="#debug-在线运行-android" class="table-of-contents__link toc-highlight">debug 在线运行 Android</a></li><li><a href="#release-离线打包-android" class="table-of-contents__link toc-highlight">release 离线打包 Android</a><ul><li><a href="#生成签名库拷贝至-androidapp" class="table-of-contents__link toc-highlight">生成签名库,拷贝至 android/app/</a></li><li><a href="#设置全局变量-gradlegradleproperties" class="table-of-contents__link toc-highlight">设置全局变量 <code>~/.gradle/gradle.properties</code></a></li><li><a href="#更改-androidappbuildgradle" class="table-of-contents__link toc-highlight">更改 android/app/build.gradle</a></li><li><a href="#生成-apk" class="table-of-contents__link toc-highlight">生成 apk</a></li><li><a href="#生成-aab" class="table-of-contents__link toc-highlight">生成 aab</a></li></ul></li><li><a href="#release-在线更新热更新" class="table-of-contents__link toc-highlight">release 在线更新（热更新）</a></li><li><a href="#安装-react-dom" class="table-of-contents__link toc-highlight">安装 react-dom</a></li><li><a href="#rn--060-的安装-react-native-web" class="table-of-contents__link toc-highlight">RN &gt;= 0.60 的安装 react-native-web</a><ul><li><a href="#react-scripts3" class="table-of-contents__link toc-highlight"><code>react-scripts@3</code></a></li><li><a href="#upgrade-to-react-scripts5-and-add-web-workers-support" class="table-of-contents__link toc-highlight">Upgrade to <code>react-scripts@5</code> and Add Web Workers support</a></li><li><a href="#qa" class="table-of-contents__link toc-highlight">Q&amp;A</a></li><li><a href="#cannot-find-module-ajvdistcompilecodegen" class="table-of-contents__link toc-highlight"><code>Cannot find module &#39;ajv/dist/compile/codegen&#39;</code></a></li></ul></li><li><a href="#rn--060-的安装-react-web" class="table-of-contents__link toc-highlight">RN &lt; 0.60 的安装 react-web</a></li><li><a href="#配置-ios-开发环境" class="table-of-contents__link toc-highlight">配置 iOS 开发环境</a></li><li><a href="#xcode-编译过程问题集锦" class="table-of-contents__link toc-highlight">Xcode 编译过程问题集锦</a></li><li><a href="#app-store-反人类集锦" class="table-of-contents__link toc-highlight">App Store 反人类集锦</a></li><li><a href="#app-store-更新-app-流程" class="table-of-contents__link toc-highlight">App Store 更新 APP 流程</a></li><li><a href="#使用-cocoapods-安装-ios-第三方库" class="table-of-contents__link toc-highlight">使用 Cocoapods 安装 iOS 第三方库</a><ul><li><a href="#一些-cocoapods-使用技巧" class="table-of-contents__link toc-highlight">一些 Cocoapods 使用技巧</a></li></ul></li><li><a href="#redux" class="table-of-contents__link toc-highlight">Redux</a><ul><li><a href="#isolating-redux-sub-apps" class="table-of-contents__link toc-highlight">Isolating Redux Sub-Apps</a></li></ul></li><li><a href="#react-native-unimodules" class="table-of-contents__link toc-highlight">react-native-unimodules</a><ul><li><a href="#install-react-native-unimodules-without-install-expo" class="table-of-contents__link toc-highlight">install react-native-unimodules without install expo</a></li></ul></li><li><a href="#一些-bug-的解决方法" class="table-of-contents__link toc-highlight">一些 BUG 的解决方法</a><ul><li><a href="#fixed-typeerror-network-request-failed-when-upload-file-to-http-not-https-with-android-debug-builds" class="table-of-contents__link toc-highlight">fixed <code>TypeError: Network request failed</code> when upload file to http not https with Android debug builds</a></li><li><a href="#fixed-xmobile-calling-netinterfaceaddrs-fails-on-android-sdk-30-if-use-go-on-android--11" class="table-of-contents__link toc-highlight">Fixed x/mobile: Calling net.InterfaceAddrs() fails on Android SDK 30 if use GO on Android &gt;= 11</a></li><li><a href="#rootdirnode_modulesreact-nativeandroid-as-react-native-android-import-from-node_modules-directory-does-not-working" class="table-of-contents__link toc-highlight"><code>$rootDir/../node_modules/react-native/android</code> as React-Native Android import from node_modules directory does not working</a></li><li><a href="#recompile-with--xlint-for-details" class="table-of-contents__link toc-highlight">Recompile with -Xlint for details</a></li><li><a href="#compile-some-3rd-lib-got-read-timed-out-could-not-get-httpsmavengooglecomcomfacebookreactreact-nativemaven-metadataxml" class="table-of-contents__link toc-highlight">Compile some 3rd lib got <code>Read timed out</code> <code>Could not GET &#39;https://maven.google.com/com/facebook/react/react-native/maven-metadata.xml&#39;</code></a></li><li><a href="#aapt-error-resource-androidattrcolorerror-not-found" class="table-of-contents__link toc-highlight"><code>AAPT: error: resource android:attr/colorError not found</code></a></li><li><a href="#could-not-resolve-orgwebkitandroid-jsc" class="table-of-contents__link toc-highlight"><code>Could not resolve org.webkit:android-jsc:+</code></a></li><li><a href="#专治各种网络不服" class="table-of-contents__link toc-highlight">专治各种网络不服</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/g/docs">Docs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/g/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/flyskywhy/g" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>