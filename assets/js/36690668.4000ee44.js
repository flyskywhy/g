"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5447],{4311:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>d,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript/ReactNative\u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdbAPP\u7684\u65b9\u6cd5","title":"ReactNative\u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdbAPP\u7684\u65b9\u6cd5","description":"Li Zheng flyskywhy@gmail.com","source":"@site/../g/i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript/ReactNative\u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdbAPP\u7684\u65b9\u6cd5.md","sourceDirName":"i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript","slug":"/i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript/ReactNative\u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdbAPP\u7684\u65b9\u6cd5","permalink":"/g/docs/i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript/ReactNative\u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdbAPP\u7684\u65b9\u6cd5","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ReactNative\u9879\u76ee\u4e2d\u547d\u4ee4\u884c\u7f16\u8bd1iOS\u7248\u7684\u65b9\u6cd5","permalink":"/g/docs/i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript/ReactNative\u9879\u76ee\u4e2d\u547d\u4ee4\u884c\u7f16\u8bd1iOS\u7248\u7684\u65b9\u6cd5"},"next":{"title":"React\u4f7f\u7528\u8be6\u89e3","permalink":"/g/docs/i\u4e3b\u89c2\u7684\u4f53\u9a8c\u65b9\u5f0f/t\u5feb\u4e50\u7684\u4f53\u9a8c/\u7535\u4fe1/Tool/\u7f16\u7a0b\u8bed\u8a00/JavaScript/React\u4f7f\u7528\u8be6\u89e3"}}');var t=r(4848),i=r(8453);const d={},s="React Native \u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdb APP \u7684\u65b9\u6cd5",c={},o=[{value:"\u65b9\u6cd5\u4e00\u3001\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u7ec4",id:"\u65b9\u6cd5\u4e00\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u7ec4",level:2},{value:"\u751f\u6210\u6570\u7ec4",id:"\u751f\u6210\u6570\u7ec4",level:3},{value:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e",id:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e",level:3},{value:"\u65b9\u6cd5\u4e8c\u3001\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u56fe\u7247",id:"\u65b9\u6cd5\u4e8c\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u56fe\u7247",level:2},{value:"\u751f\u6210\u7279\u5236 bmp \u6587\u4ef6",id:"\u751f\u6210\u7279\u5236-bmp-\u6587\u4ef6",level:3},{value:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e",id:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e-1",level:3},{value:"Development",id:"development",level:4},{value:"Production",id:"production",level:4}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Li Zheng ",(0,t.jsx)(n.a,{href:"mailto:flyskywhy@gmail.com",children:"flyskywhy@gmail.com"})]}),"\n",(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"react-native-\u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdb-app-\u7684\u65b9\u6cd5",children:"React Native \u9879\u76ee\u4e2d\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdb APP \u7684\u65b9\u6cd5"})}),"\n",(0,t.jsxs)(n.p,{children:["\u672c\u6587\u4e3b\u8981\u8bb2\u8ff0\u628a\u4efb\u610f\u4e8c\u8fdb\u5236\u6587\u4ef6\u6253\u5305\u8fdb APP \u7684\u65b9\u6cd5\uff0c\u81f3\u4e8e\u76f4\u63a5\u4ece APP \u8fd0\u884c\u65f6\u6240\u5728\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u9009\u62e9\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u65b9\u6cd5\uff0c\u5219\u914d\u5408 ",(0,t.jsx)(n.a,{href:"https://github.com/prscX/react-native-file-selector",children:"react-native-file-selector"})," \u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://github.com/joltup/rn-fetch-blob",children:"rn-fetch-blob"})," \u5373\u53ef\u3002"]}),"\n",(0,t.jsx)(n.h2,{id:"\u65b9\u6cd5\u4e00\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u7ec4",children:"\u65b9\u6cd5\u4e00\u3001\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u7ec4"}),"\n",(0,t.jsx)(n.p,{children:"\u57fa\u672c\u601d\u8def\u662f\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210 JS \u6807\u51c6\u7684\u6570\u7ec4\uff0c\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e00\u4e2a\u5b57\u8282\u7684\u6570\u5b57\u8868\u793a\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"\u751f\u6210\u6570\u7ec4",children:"\u751f\u6210\u6570\u7ec4"}),"\n",(0,t.jsxs)(n.p,{children:["\u9996\u5148\u5b89\u88c5\u5c06 ",(0,t.jsx)(n.code,{children:".bin"})," \u6587\u4ef6\u8f6c\u6362\u6210 ",(0,t.jsx)(n.code,{children:".c"})," \u6587\u4ef6\u7684\u5de5\u5177\uff1a"]}),"\n",(0,t.jsx)(n.p,{children:"npm install -g bin2carray"}),"\n",(0,t.jsxs)(n.p,{children:["\u7136\u540e\u5728\u6bd4\u5982 ",(0,t.jsx)(n.code,{children:"firmwareV3.1.bin"})," \u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff1a"]}),"\n",(0,t.jsx)(n.p,{children:"bin2carray firmwareV3.1"}),"\n",(0,t.jsx)(n.p,{children:"\u6700\u540e\u5c06\u4e0a\u9762\u547d\u4ee4\u6240\u751f\u6210\u7684 firmwareV3.1.c \u6587\u4ef6\u4e2d\u7684"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"    const unsigned char bin2carray_firmwareV3.1[64820] = {\n    ...\n    };\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4fee\u6539\u4e3a"}),"\n",(0,t.jsx)(n.p,{children:"export default [\n...\n];"}),"\n",(0,t.jsxs)(n.p,{children:["\u5e76\u53e6\u5b58\u4e3a ",(0,t.jsx)(n.code,{children:"firmwareV3.1.js"})," \u5373\u53ef\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e",children:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"actions.startOta({\n    firmware: require('../images/firmware/firmwareV3.1.js').default\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u65b9\u6cd5\u4e8c\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u56fe\u7247",children:"\u65b9\u6cd5\u4e8c\u3001\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210\u56fe\u7247"}),"\n",(0,t.jsxs)(n.p,{children:["\u57fa\u672c\u601d\u8def\u662f\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210 RN \u6253\u5305\u5de5\u5177\u80fd\u591f\u8ba4\u8bc6\u7684\u6587\u4ef6\u7c7b\u578b\u4e5f\u5c31\u662f ",(0,t.jsx)(n.code,{children:"node_modules/metro-bundler/src/defaults.js"})," \u7684 ",(0,t.jsx)(n.code,{children:"assetExts[]"})," \u4e2d\u7684\u90a3\u4e9b\u540e\u7f00\u540d\u3002\u672c\u6587\u4ee5 ",(0,t.jsx)(n.code,{children:".bmp"})," \u4e3a\u4f8b\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"\u751f\u6210\u7279\u5236-bmp-\u6587\u4ef6",children:"\u751f\u6210\u7279\u5236 bmp \u6587\u4ef6"}),"\n",(0,t.jsx)(n.p,{children:"\u9996\u5148\u4f7f\u7528\u56fe\u50cf\u8f6f\u4ef6\u751f\u6210\u4e00\u4e2a\u4ec5\u4e00\u4e2a\u50cf\u7d20\u7684 head.bmp \u6587\u4ef6\uff0c\u6587\u4ef6\u5927\u5c0f\u4e00\u822c\u4e3a 58 \u5b57\u8282\uff0c\u7136\u540e\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u5c06\u6bd4\u5982 firmwareV3.1.bin \u7684\u6587\u4ef6\u5185\u5bb9\u6dfb\u52a0\u5230 head.bmp \u6587\u4ef6\u540e\u9762\uff1a"}),"\n",(0,t.jsx)(n.p,{children:"cat head.bmp firmwareV3.1.bin > firmwareV3.1.bin.bmp"}),"\n",(0,t.jsx)(n.p,{children:"\u5982\u6b64\u5f97\u5230\u7684 bmp \u6587\u4ef6\uff0c\u65e2\u53ef\u4ee5\u88ab\u56fe\u50cf\u8f6f\u4ef6\u6253\u5f00\uff0c\u53c8\u53ef\u4ee5\u5728 58 \u5b57\u8282\u540e\u62e5\u6709\u6240\u9700\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e-1",children:"\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e"}),"\n",(0,t.jsx)(n.h4,{id:"development",children:"Development"}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://github.com/jDataView/jBinary/wiki/jBinary-Methods",children:"jBinary Methods"})," \u53ef\u4ee5\u8bfb\u53d6\u6307\u5b9a\u504f\u79fb\u4f4d\u7f6e\u7684\u6570\u636e\uff0c\u6bd4\u5982\u8bfb\u53d6 4 \u4e2a\u5b57\u7b26\u7684\u7248\u672c\u53f7\u4ee5\u53ca\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u8f6c\u6362\u6210\u5b57\u8282\u6570\u7ec4\u4ee5\u4fbf\u8fdb\u884c OTA \u7684\u4e24\u4e2a\u51fd\u6570\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"import resolveAssetSource from 'react-native/Libraries/Image/resolveAssetSource';\nimport jBinary from 'jbinary';\n\n    getFirmwareFileVersion = () => {\n        const head = resolveAssetSource(require('../images/firmware/head.bmp'));\n        const headAddFw = resolveAssetSource(require('../images/firmware/firmwareV3.1.bin.bmp'));\n        jBinary.loadData(head.uri).then(dataHead => {\n            const headLength = dataHead.byteLength;\n            jBinary.load(headAddFw.uri).then(dataHeadAddFw => {\n                const versionOffset = 2;\n                dataHeadAddFw.seek(headLength + versionOffset);\n\n                console.warn(\n                    dataHeadAddFw.read('char') +\n                    dataHeadAddFw.read('char') +\n                    dataHeadAddFw.read('char') +\n                    dataHeadAddFw.read('char'));\n            }, errHeadAddFw => {});\n        }, errHead => {});\n    }\n\n    startOta = () => {\n        const {\n            actions,\n        } = this.props;\n\n        const head = resolveAssetSource(require('../images/firmware/head.bmp'));\n        const headAddFw = resolveAssetSource(require('../images/firmware/firmwareV3.1.bin.bmp'));\n        jBinary.loadData(head.uri).then(dataHead => {\n            const headLength = dataHead.byteLength;\n            jBinary.load(headAddFw.uri).then(dataHeadAddFw => {\n                const firmware = dataHeadAddFw.read([\n                    'array',\n                    'uint8',\n                    dataHeadAddFw.view.byteLength - headLength\n                ], headLength);\n                actions.startOta({\n                    firmware\n                });\n            }, errHeadAddFw => {});\n        }, errHead => {});\n    }\n"})}),"\n",(0,t.jsx)(n.h4,{id:"production",children:"Production"}),"\n",(0,t.jsxs)(n.p,{children:["\u53ef\u53c2\u8003 ",(0,t.jsx)(n.a,{href:"https://stackoverflow.com/a/54594945/6318705",children:"How to read local images (Get base64 of local file)"})," \u4e2d\u7684 Production \uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>s});var a=r(6540);const t={},i=a.createContext(t);function d(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);